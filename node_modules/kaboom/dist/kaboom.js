var kaboom=(()=>{var tt=Object.defineProperty;var vs=Object.getOwnPropertyDescriptor;var ys=Object.getOwnPropertyNames;var Us=Object.prototype.hasOwnProperty;var Es=(i,r,a)=>r in i?tt(i,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[r]=a;var u=(i,r)=>tt(i,"name",{value:r,configurable:!0});var Yn=(i,r)=>{for(var a in r)tt(i,a,{get:r[a],enumerable:!0})},xs=(i,r,a,c)=>{if(r&&typeof r=="object"||typeof r=="function")for(let b of ys(r))!Us.call(i,b)&&b!==a&&tt(i,b,{get:()=>r[b],enumerable:!(c=vs(r,b))||c.enumerable});return i};var Ss=i=>xs(tt({},"__esModule",{value:!0}),i);var Z=(i,r,a)=>(Es(i,typeof r!="symbol"?r+"":r,a),a);var Cs=(()=>{for(var i=new Uint8Array(128),r=0;r<64;r++)i[r<26?r+65:r<52?r+71:r<62?r-4:r*4-205]=r;return a=>{for(var c=a.length,b=new Uint8Array((c-(a[c-1]=="=")-(a[c-2]=="="))*3/4|0),p=0,T=0;p<c;){var R=i[a.charCodeAt(p++)],C=i[a.charCodeAt(p++)],O=i[a.charCodeAt(p++)],M=i[a.charCodeAt(p++)];b[T++]=R<<2|C>>4,b[T++]=C<<4|O>>2,b[T++]=O<<6|M}return b}})();var eo={};Yn(eo,{default:()=>Ws});function fe(i){return i*Math.PI/180}u(fe,"deg2rad");function Ht(i){return i*180/Math.PI}u(Ht,"rad2deg");function ne(i,r,a){return r>a?ne(i,a,r):Math.min(Math.max(i,r),a)}u(ne,"clamp");function ze(i,r,a){return i+(r-i)*a}u(ze,"lerp");function wt(i,r,a,c,b){return c+(i-r)/(a-r)*(b-c)}u(wt,"map");function Zn(i,r,a,c,b){return ne(wt(i,r,a,c,b),c,b)}u(Zn,"mapc");var H=class{x=0;y=0;constructor(r=0,a=r){this.x=r,this.y=a}static fromAngle(r){let a=fe(r);return new H(Math.cos(a),Math.sin(a))}clone(){return new H(this.x,this.y)}add(...r){let a=f(...r);return new H(this.x+a.x,this.y+a.y)}sub(...r){let a=f(...r);return new H(this.x-a.x,this.y-a.y)}scale(...r){let a=f(...r);return new H(this.x*a.x,this.y*a.y)}dist(...r){let a=f(...r);return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y))}len(){return this.dist(new H(0,0))}unit(){let r=this.len();return r===0?new H(0):this.scale(1/r)}normal(){return new H(this.y,-this.x)}dot(r){return this.x*r.x+this.y*r.y}angle(...r){let a=f(...r);return Ht(Math.atan2(this.y-a.y,this.x-a.x))}lerp(r,a){return new H(ze(this.x,r.x,a),ze(this.y,r.y,a))}isZero(){return this.x===0&&this.y===0}toFixed(r){return new H(Number(this.x.toFixed(r)),Number(this.y.toFixed(r)))}eq(r){return this.x===r.x&&this.y===r.y}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}},D=H;u(D,"Vec2"),Z(D,"LEFT",new H(-1,0)),Z(D,"RIGHT",new H(1,0)),Z(D,"UP",new H(0,-1)),Z(D,"DOWN",new H(0,1));function f(...i){if(i.length===1){if(i[0]instanceof D)return f(i[0].x,i[0].y);if(Array.isArray(i[0])&&i[0].length===2)return f(...i[0])}return new D(...i)}u(f,"vec2");var _e=class{x=0;y=0;z=0;constructor(r,a,c){this.x=r,this.y=a,this.z=c}xy(){return f(this.x,this.y)}};u(_e,"Vec3");var ge=u((i,r,a)=>new _e(i,r,a),"vec3"),oe=class{r=255;g=255;b=255;constructor(r,a,c){this.r=ne(r,0,255),this.g=ne(a,0,255),this.b=ne(c,0,255)}static fromArray(r){return new oe(r[0],r[1],r[2])}static fromHex(r){if(typeof r=="number")return new oe(r>>16&255,r>>8&255,r>>0&255);{let a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return new oe(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16))}}static fromHSL(r,a,c){if(a==0)return E(255*c,255*c,255*c);let b=u((M,U,g)=>(g<0&&(g+=1),g>1&&(g-=1),g<1/6?M+(U-M)*6*g:g<1/2?U:g<2/3?M+(U-M)*(2/3-g)*6:M),"hue2rgb"),p=c<.5?c*(1+a):c+a-c*a,T=2*c-p,R=b(T,p,r+1/3),C=b(T,p,r),O=b(T,p,r-1/3);return new oe(Math.round(R*255),Math.round(C*255),Math.round(O*255))}clone(){return new oe(this.r,this.g,this.b)}lighten(r){return new oe(this.r+r,this.g+r,this.b+r)}darken(r){return this.lighten(-r)}invert(){return new oe(255-this.r,255-this.g,255-this.b)}mult(r){return new oe(this.r*r.r/255,this.g*r.g/255,this.b*r.b/255)}eq(r){return this.r===r.r&&this.g===r.g&&this.b===r.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}},x=oe;u(x,"Color"),Z(x,"RED",E(255,0,0)),Z(x,"GREEN",E(0,255,0)),Z(x,"BLUE",E(0,0,255)),Z(x,"YELLOW",E(255,255,0)),Z(x,"MAGENTA",E(255,0,255)),Z(x,"CYAN",E(0,255,255)),Z(x,"WHITE",E(255,255,255)),Z(x,"BLACK",E(0,0,0));function E(...i){if(i.length===0)return new x(255,255,255);if(i.length===1){if(i[0]instanceof x)return i[0].clone();if(Array.isArray(i[0])&&i[0].length===3)return x.fromArray(i[0])}return new x(...i)}u(E,"rgb");var Wn=u((i,r,a)=>x.fromHSL(i,r,a),"hsl2rgb"),j=class{x=0;y=0;w=1;h=1;constructor(r,a,c,b){this.x=r,this.y=a,this.w=c,this.h=b}scale(r){return new j(this.x+this.w*r.x,this.y+this.h*r.y,this.w*r.w,this.h*r.h)}clone(){return new j(this.x,this.y,this.w,this.h)}eq(r){return this.x===r.x&&this.y===r.y&&this.w===r.w&&this.h===r.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};u(j,"Quad");function er(i,r,a,c){return new j(i,r,a,c)}u(er,"quad");var A=class{m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(r){r&&(this.m=r)}static translate(r){return new A([1,0,0,0,0,1,0,0,0,0,1,0,r.x,r.y,0,1])}static scale(r){return new A([r.x,0,0,0,0,r.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(r){return r=fe(-r),new A([1,0,0,0,0,Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1])}static rotateY(r){return r=fe(-r),new A([Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1])}static rotateZ(r){return r=fe(-r),new A([Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1])}translate(r){return this.mult(A.translate(r))}scale(r){return this.mult(A.scale(r))}rotateX(r){return this.mult(A.rotateX(r))}rotateY(r){return this.mult(A.rotateY(r))}rotateZ(r){return this.mult(A.rotateZ(r))}mult(r){let a=[];for(let c=0;c<4;c++)for(let b=0;b<4;b++)a[c*4+b]=this.m[0*4+b]*r.m[c*4+0]+this.m[1*4+b]*r.m[c*4+1]+this.m[2*4+b]*r.m[c*4+2]+this.m[3*4+b]*r.m[c*4+3];return new A(a)}multVec4(r){return{x:r.x*this.m[0]+r.y*this.m[4]+r.z*this.m[8]+r.w*this.m[12],y:r.x*this.m[1]+r.y*this.m[5]+r.z*this.m[9]+r.w*this.m[13],z:r.x*this.m[2]+r.y*this.m[6]+r.z*this.m[10]+r.w*this.m[14],w:r.x*this.m[3]+r.y*this.m[7]+r.z*this.m[11]+r.w*this.m[15]}}multVec3(r){let a=this.multVec4({x:r.x,y:r.y,z:r.z,w:1});return ge(a.x,a.y,a.z)}multVec2(r){return f(r.x*this.m[0]+r.y*this.m[4]+0*this.m[8]+1*this.m[12],r.x*this.m[1]+r.y*this.m[5]+0*this.m[9]+1*this.m[13])}invert(){let r=[],a=this.m[10]*this.m[15]-this.m[14]*this.m[11],c=this.m[9]*this.m[15]-this.m[13]*this.m[11],b=this.m[9]*this.m[14]-this.m[13]*this.m[10],p=this.m[8]*this.m[15]-this.m[12]*this.m[11],T=this.m[8]*this.m[14]-this.m[12]*this.m[10],R=this.m[8]*this.m[13]-this.m[12]*this.m[9],C=this.m[6]*this.m[15]-this.m[14]*this.m[7],O=this.m[5]*this.m[15]-this.m[13]*this.m[7],M=this.m[5]*this.m[14]-this.m[13]*this.m[6],U=this.m[4]*this.m[15]-this.m[12]*this.m[7],g=this.m[4]*this.m[14]-this.m[12]*this.m[6],le=this.m[5]*this.m[15]-this.m[13]*this.m[7],I=this.m[4]*this.m[13]-this.m[12]*this.m[5],Y=this.m[6]*this.m[11]-this.m[10]*this.m[7],Ce=this.m[5]*this.m[11]-this.m[9]*this.m[7],Te=this.m[5]*this.m[10]-this.m[9]*this.m[6],it=this.m[4]*this.m[11]-this.m[8]*this.m[7],st=this.m[4]*this.m[10]-this.m[8]*this.m[6],Ae=this.m[4]*this.m[9]-this.m[8]*this.m[5];r[0]=this.m[5]*a-this.m[6]*c+this.m[7]*b,r[4]=-(this.m[4]*a-this.m[6]*p+this.m[7]*T),r[8]=this.m[4]*c-this.m[5]*p+this.m[7]*R,r[12]=-(this.m[4]*b-this.m[5]*T+this.m[6]*R),r[1]=-(this.m[1]*a-this.m[2]*c+this.m[3]*b),r[5]=this.m[0]*a-this.m[2]*p+this.m[3]*T,r[9]=-(this.m[0]*c-this.m[1]*p+this.m[3]*R),r[13]=this.m[0]*b-this.m[1]*T+this.m[2]*R,r[2]=this.m[1]*C-this.m[2]*O+this.m[3]*M,r[6]=-(this.m[0]*C-this.m[2]*U+this.m[3]*g),r[10]=this.m[0]*le-this.m[1]*U+this.m[3]*I,r[14]=-(this.m[0]*M-this.m[1]*g+this.m[2]*I),r[3]=-(this.m[1]*Y-this.m[2]*Ce+this.m[3]*Te),r[7]=this.m[0]*Y-this.m[2]*it+this.m[3]*st,r[11]=-(this.m[0]*Ce-this.m[1]*it+this.m[3]*Ae),r[15]=this.m[0]*Te-this.m[1]*st+this.m[2]*Ae;let xt=this.m[0]*r[0]+this.m[1]*r[4]+this.m[2]*r[8]+this.m[3]*r[12];for(let Oe=0;Oe<4;Oe++)for(let Pe=0;Pe<4;Pe++)r[Oe*4+Pe]*=1/xt;return new A(r)}clone(){return new A(this.m)}toString(){return this.m.toString()}};u(A,"Mat4");function $t(i,r,a,c=Math.sin){return i+(c(a)+1)/2*(r-i)}u($t,"wave");var Ts=1103515245,As=12345,Xn=2147483648,ke=class{seed;constructor(r){this.seed=r}gen(){return this.seed=(Ts*this.seed+As)%Xn,this.seed/Xn}genNumber(r,a){return r+this.gen()*(a-r)}genVec2(r,a){return new D(this.genNumber(r.x,a.x),this.genNumber(r.y,a.y))}genColor(r,a){return new x(this.genNumber(r.r,a.r),this.genNumber(r.g,a.g),this.genNumber(r.b,a.b))}genAny(...r){if(r.length===0)return this.gen();if(r.length===1){if(typeof r[0]=="number")return this.genNumber(0,r[0]);if(r[0]instanceof D)return this.genVec2(f(0,0),r[0]);if(r[0]instanceof x)return this.genColor(E(0,0,0),r[0])}else if(r.length===2){if(typeof r[0]=="number"&&typeof r[1]=="number")return this.genNumber(r[0],r[1]);if(r[0]instanceof D&&r[1]instanceof D)return this.genVec2(r[0],r[1]);if(r[0]instanceof x&&r[1]instanceof x)return this.genColor(r[0],r[1])}}};u(ke,"RNG");var zt=new ke(Date.now());function tr(i){return i!=null&&(zt.seed=i),zt.seed}u(tr,"randSeed");function nt(...i){return zt.genAny(...i)}u(nt,"rand");function Yt(...i){return Math.floor(nt(...i))}u(Yt,"randi");function nr(i){return nt()<=i}u(nr,"chance");function rr(i){return i[Yt(i.length)]}u(rr,"choose");function ir(i,r){return i.pos.x+i.width>r.pos.x&&i.pos.x<r.pos.x+r.width&&i.pos.y+i.height>r.pos.y&&i.pos.y<r.pos.y+r.height}u(ir,"testRectRect");function Os(i,r){if(i.p1.x===i.p2.x&&i.p1.y===i.p2.y||r.p1.x===r.p2.x&&r.p1.y===r.p2.y)return null;let a=(r.p2.y-r.p1.y)*(i.p2.x-i.p1.x)-(r.p2.x-r.p1.x)*(i.p2.y-i.p1.y);if(a===0)return null;let c=((r.p2.x-r.p1.x)*(i.p1.y-r.p1.y)-(r.p2.y-r.p1.y)*(i.p1.x-r.p1.x))/a,b=((i.p2.x-i.p1.x)*(i.p1.y-r.p1.y)-(i.p2.y-i.p1.y)*(i.p1.x-r.p1.x))/a;return c<0||c>1||b<0||b>1?null:c}u(Os,"testLineLineT");function je(i,r){let a=Os(i,r);return a?f(i.p1.x+a*(i.p2.x-i.p1.x),i.p1.y+a*(i.p2.y-i.p1.y)):null}u(je,"testLineLine");function sr(i,r){if(He(i,r.p1)||He(i,r.p2))return!0;let a=i.points();return!!je(r,new ie(a[0],a[1]))||!!je(r,new ie(a[1],a[2]))||!!je(r,new ie(a[2],a[3]))||!!je(r,new ie(a[3],a[0]))}u(sr,"testRectLine");function He(i,r){return r.x>i.pos.x&&r.x<i.pos.x+i.width&&r.y>i.pos.y&&r.y<i.pos.y+i.height}u(He,"testRectPoint");function or(i,r){return i.center.dist(r)<i.radius}u(or,"testCirclePoint");function ar(i,r){let a=!1,c=i.pts;for(let b=0,p=c.length-1;b<c.length;p=b++)c[b].y>r.y!=c[p].y>r.y&&r.x<(c[p].x-c[b].x)*(r.y-c[b].y)/(c[p].y-c[b].y)+c[b].x&&(a=!a);return a}u(ar,"testPolygonPoint");var ie=class{p1;p2;constructor(r,a){this.p1=r,this.p2=a}transform(r){return new ie(r.multVec2(this.p1),r.multVec2(this.p2))}bbox(){return G.fromPoints(this.p1,this.p2)}};u(ie,"Line");var G=class{pos;width;height;constructor(r,a,c){this.pos=r,this.width=a,this.height=c}static fromPoints(r,a){return new G(r.clone(),a.x-r.x,a.y-r.y)}center(){return new D(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(r){return new ae(this.points().map(a=>r.multVec2(a)))}bbox(){return new G(this.pos.clone(),this.width,this.height)}distToPoint(r){let a=this.pos,c=this.pos.add(this.width,this.height),b=Math.max(a.x-r.x,0,r.x-c.x),p=Math.max(a.y-r.y,0,r.y-c.y);return Math.sqrt(b*b+p*p)}};u(G,"Rect");var me=class{center;radius;constructor(r,a){this.center=r,this.radius=a}transform(r){return new qe(this.center,this.radius,this.radius).transform(r)}bbox(){return G.fromPoints(this.center.sub(f(this.radius)),this.center.add(f(this.radius)))}};u(me,"Circle");var qe=class{center;radiusX;radiusY;constructor(r,a,c){this.center=r,this.radiusX=a,this.radiusY=c}transform(r){return new qe(r.multVec2(this.center),r.m[0]*this.radiusX,r.m[5]*this.radiusY)}bbox(){return G.fromPoints(this.center.sub(f(this.radiusX,this.radiusY)),this.center.add(f(this.radiusX,this.radiusY)))}};u(qe,"Ellipse");var ae=class{pts;constructor(r){if(r.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=r}transform(r){return new ae(this.pts.map(a=>r.multVec2(a)))}bbox(){let r=f(Number.MAX_VALUE),a=f(-Number.MAX_VALUE);for(let c of this.pts)r.x=Math.min(r.x,c.x),a.x=Math.max(a.x,c.x),r.y=Math.min(r.y,c.y),a.y=Math.max(a.y,c.y);return G.fromPoints(r,a)}};u(ae,"Polygon");function ur(i,r){let a=Number.MAX_VALUE,c=f(0);for(let b of[i,r])for(let p=0;p<b.pts.length;p++){let T=b.pts[p],C=b.pts[(p+1)%b.pts.length].sub(T).normal().unit(),O=Number.MAX_VALUE,M=-Number.MAX_VALUE;for(let I=0;I<i.pts.length;I++){let Y=i.pts[I].dot(C);O=Math.min(O,Y),M=Math.max(M,Y)}let U=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let I=0;I<r.pts.length;I++){let Y=r.pts[I].dot(C);U=Math.min(U,Y),g=Math.max(g,Y)}let le=Math.min(M,g)-Math.max(O,U);if(le<0)return null;if(le<Math.abs(a)){let I=g-O,Y=U-M;a=Math.abs(I)<Math.abs(Y)?I:Y,c=C.scale(a)}}return c}u(ur,"sat");var gt=1.70158,pt=gt*1.525,Kn=gt+1,Qn=2*Math.PI/3,Jn=2*Math.PI/4.5,pe={linear:i=>i,easeInSine:i=>1-Math.cos(i*Math.PI/2),easeOutSine:i=>Math.sin(i*Math.PI/2),easeInOutSine:i=>-(Math.cos(Math.PI*i)-1)/2,easeInQuad:i=>i*i,easeOutQuad:i=>1-(1-i)*(1-i),easeInOutQuad:i=>i<.5?2*i*i:1-Math.pow(-2*i+2,2)/2,easeInCubic:i=>i*i*i,easeOutCubic:i=>1-Math.pow(1-i,3),easeInOutCubic:i=>i<.5?4*i*i*i:1-Math.pow(-2*i+2,3)/2,easeInQuart:i=>i*i*i*i,easeOutQuart:i=>1-Math.pow(1-i,4),easeInOutQuart:i=>i<.5?8*i*i*i*i:1-Math.pow(-2*i+2,4)/2,easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>1-Math.pow(1-i,5),easeInOutQuint:i=>i<.5?16*i*i*i*i*i:1-Math.pow(-2*i+2,5)/2,easeInExpo:i=>i===0?0:Math.pow(2,10*i-10),easeOutExpo:i=>i===1?1:1-Math.pow(2,-10*i),easeInOutExpo:i=>i===0?0:i===1?1:i<.5?Math.pow(2,20*i-10)/2:(2-Math.pow(2,-20*i+10))/2,easeInCirc:i=>1-Math.sqrt(1-Math.pow(i,2)),easeOutCirc:i=>Math.sqrt(1-Math.pow(i-1,2)),easeInOutCirc:i=>i<.5?(1-Math.sqrt(1-Math.pow(2*i,2)))/2:(Math.sqrt(1-Math.pow(-2*i+2,2))+1)/2,easeInBack:i=>Kn*i*i*i-gt*i*i,easeOutBack:i=>1+Kn*Math.pow(i-1,3)+gt*Math.pow(i-1,2),easeInOutBack:i=>i<.5?Math.pow(2*i,2)*((pt+1)*2*i-pt)/2:(Math.pow(2*i-2,2)*((pt+1)*(i*2-2)+pt)+2)/2,easeInElastic:i=>i===0?0:i===1?1:-Math.pow(2,10*i-10)*Math.sin((i*10-10.75)*Qn),easeOutElastic:i=>i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i*10-.75)*Qn)+1,easeInOutElastic:i=>i===0?0:i===1?1:i<.5?-(Math.pow(2,20*i-10)*Math.sin((20*i-11.125)*Jn))/2:Math.pow(2,-20*i+10)*Math.sin((20*i-11.125)*Jn)/2+1,easeInBounce:i=>1-pe.easeOutBounce(1-i),easeOutBounce:i=>i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375,easeInOutBounce:i=>i<.5?(1-pe.easeOutBounce(1-2*i))/2:(1+pe.easeOutBounce(2*i-1))/2};var Se=class extends Map{lastID;constructor(...r){super(...r),this.lastID=0}push(r){let a=this.lastID;return this.set(a,r),this.lastID++,a}pushd(r){let a=this.push(r);return()=>this.delete(a)}};u(Se,"IDList");var W=class{handlers=new Se;add(r){let a=this.handlers.pushd((...b)=>{c.paused||r(...b)}),c={paused:!1,cancel:a};return c}addOnce(r){let a=this.add((...c)=>{a.cancel(),r(...c)});return a}next(){return new Promise(r=>this.addOnce(r))}trigger(...r){this.handlers.forEach(a=>a(...r))}numListeners(){return this.handlers.size}};u(W,"Event");var ue=class{handlers=new Map;on(r,a){return this.handlers.get(r)||this.handlers.set(r,new W),this.handlers.get(r).add(a)}onOnce(r,a){let c=this.on(r,(...b)=>{c.cancel(),a(...b)});return c}next(r){return new Promise(a=>{this.onOnce(r,a)})}trigger(r,...a){this.handlers.get(r)&&this.handlers.get(r).trigger(...a)}remove(r){this.handlers.delete(r)}clear(){this.handlers=new Map}numListeners(r){return this.handlers.get(r)?.numListeners()??0}};u(ue,"EventHandler");function Xt(i,r){let a=typeof i,c=typeof r;if(a!==c)return!1;if(a==="object"&&c==="object"){let b=Object.keys(i),p=Object.keys(r);if(b.length!==p.length)return!1;for(let T of b){let R=i[T],C=r[T];if(!(typeof R=="function"&&typeof C=="function")&&!Xt(R,C))return!1}return!0}return i===r}u(Xt,"deepEq");function Ps(i){let r=window.atob(i),a=r.length,c=new Uint8Array(a);for(let b=0;b<a;b++)c[b]=r.charCodeAt(b);return c.buffer}u(Ps,"base64ToArrayBuffer");function cr(i){return Ps(i.split(",")[1])}u(cr,"dataURLToArrayBuffer");function bt(i,r){let a=document.createElement("a");a.href=r,a.download=i,a.click()}u(bt,"download");function Kt(i,r){bt(i,"data:text/plain;charset=utf-8,"+r)}u(Kt,"downloadText");function lr(i,r){Kt(i,JSON.stringify(r))}u(lr,"downloadJSON");function Qt(i,r){let a=URL.createObjectURL(r);bt(i,a),URL.revokeObjectURL(a)}u(Qt,"downloadBlob");function Jt(i){return i.match(/^data:\w+\/\w+;base64,.+/)}u(Jt,"isDataURL");var hr=(()=>{let i=0;return()=>i++})();var $e=class{dts=[];timer=0;fps=0;tick(r){this.dts.push(r),this.timer+=r,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((a,c)=>a+c)/this.dts.length)),this.dts=[])}};u($e,"FPSCounter");var we=class{time;action;finished=!1;paused=!1;constructor(r,a){this.time=r,this.action=a}tick(r){return this.finished||this.paused?!1:(this.time-=r,this.time<=0?(this.action(),this.finished=!0,this.time=0,!0):!1)}reset(r){this.time=r,this.finished=!1}};u(we,"Timer");var dr="data:image/png;base64,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";var fr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==";var Ms={};Yn(Ms,{default:()=>Zt});var Zt=Cs("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");var mr="data:image/png;base64,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";var pr="data:image/png;base64,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";var Is="3000.0.0-alpha.10",gr={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},wr=["left","middle","right","back","forward"],Vs=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","s"],br=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",vr=0,yr=3,Gs=0,Ns=3,js=-1200,_s=1200,vt="topleft",Ur=64,ks="happy",yt="monospace",qs=36,Er=64,Ut=1024,xr=.1,zs=1,Tr=[{name:"a_pos",size:3},{name:"a_uv",size:2},{name:"a_color",size:4}],Et=Tr.reduce((i,r)=>i+r.size,0),Ar=2048,Sr=Ar*4*Et,Cr=Ar*6,Hs=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,$s=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,Wt=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,en=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,Ys=new Set(["id","require"]),Xs=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function tn(i){return i==="pressed"||i==="rpressed"?"down":i==="released"?"up":i}u(tn,"processButtonState");function Ks(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}u(Ks,"enterFullscreen");function Qs(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}u(Qs,"exitFullscreen");function Js(){return document.fullscreenElement||document.webkitFullscreenElement}u(Js,"getFullscreenElement");function rt(i){switch(i){case"topleft":return f(-1,-1);case"top":return f(0,-1);case"topright":return f(1,-1);case"left":return f(-1,0);case"center":return f(0,0);case"right":return f(1,0);case"botleft":return f(-1,1);case"bot":return f(0,1);case"botright":return f(1,1);default:return i}}u(rt,"anchorPt");function Zs(i){switch(i){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}u(Zs,"alignPt");function nn(i){return i.createBuffer(1,1,44100)}u(nn,"createEmptyAudioBuffer");var Ws=u((i={})=>{let r=[],a=(()=>{let e=i.root??document.body;e===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let t=i.canvas??(()=>{let v=document.createElement("canvas");return e.appendChild(v),v})(),n=i.scale??1,s=!(i.width&&i.height&&!i.stretch&&!i.letterbox),h=t.parentElement.offsetWidth,o=t.parentElement.offsetHeight;s?(t.width=h,t.height=o):(t.width=i.width*n,t.height=i.height*n);let l=t.width,d=t.height,m=i.pixelDensity||window.devicePixelRatio;t.width*=m,t.height*=m;let w=[`width: ${l}px`,`height: ${d}px`,"outline: none","cursor: default"];return i.crisp&&(w.push("image-rendering: pixelated"),w.push("image-rendering: crisp-edges")),t.style.cssText=w.join(";"),t.tabIndex=0,{canvas:t,canvas2:t.cloneNode(),pixelDensity:m,stretchToParent:s,lastParentWidth:h,lastParentHeight:o,keyStates:{},mouseStates:{},virtualButtonStates:{},charInputted:[],numKeyDown:0,isMouseMoved:!1,isKeyPressed:!1,isKeyPressedRepeat:!1,isKeyReleased:!1,mouseStarted:!1,mousePos:f(0,0),mouseDeltaPos:f(0,0),time:0,realTime:0,skipTime:!1,dt:0,numFrames:0,isTouchScreen:"ontouchstart"in window||navigator.maxTouchPoints>0,loopID:null,stopped:!1,paused:!1,fpsCounter:new $e}})(),c=a.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});class b{glTex;width;height;constructor(t,n,s={}){this.glTex=c.createTexture(),r.push(()=>this.free()),this.bind(),t&&n&&c.texImage2D(c.TEXTURE_2D,0,c.RGBA,t,n,0,c.RGBA,c.UNSIGNED_BYTE,null),this.width=t,this.height=n;let h=(()=>{switch(s.filter??i.texFilter){case"linear":return c.LINEAR;case"nearest":return c.NEAREST;default:return c.NEAREST}})(),o=(()=>{switch(s.wrap){case"repeat":return c.REPEAT;case"clampToEdge":return c.CLAMP_TO_EDGE;default:return c.CLAMP_TO_EDGE}})();c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,h),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,h),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,o),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,o),this.unbind()}static fromImage(t,n={}){let s=new b(0,0,n);return s.bind(),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,t),s.width=t.width,s.height=t.height,s.unbind(),s}update(t,n,s){this.bind(),c.texSubImage2D(c.TEXTURE_2D,0,t,n,c.RGBA,c.UNSIGNED_BYTE,s),this.unbind()}bind(){c.bindTexture(c.TEXTURE_2D,this.glTex)}unbind(){c.bindTexture(c.TEXTURE_2D,null)}free(){c.deleteTexture(this.glTex)}}u(b,"Texture");let p=(()=>{let e=St(Wt,en),t=b.fromImage(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1));if(i.background){let o=x.fromArray(i.background);c.clearColor(o.r/255,o.g/255,o.b/255,i.background[3]??1)}c.enable(c.BLEND),c.enable(c.SCISSOR_TEST),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);let n=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,n),c.bufferData(c.ARRAY_BUFFER,Sr*4,c.DYNAMIC_DRAW),Tr.reduce((o,l,d)=>(c.vertexAttribPointer(d,l.size,c.FLOAT,!1,Et*4,o),c.enableVertexAttribArray(d),o+l.size*4),0),c.bindBuffer(c.ARRAY_BUFFER,null);let s=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),c.bufferData(c.ELEMENT_ARRAY_BUFFER,Cr*4,c.DYNAMIC_DRAW),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null);let h=b.fromImage(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{drawCalls:0,lastDrawCalls:0,defShader:e,curShader:e,defTex:t,curTex:t,curUniform:{},vbuf:n,ibuf:s,vqueue:[],iqueue:[],transform:new A,transformStack:[],bgTex:h,width:i.width,height:i.height,viewport:{x:0,y:0,width:c.drawingBufferWidth,height:c.drawingBufferHeight}}})();class T{tex;frames=[new j(0,0,1,1)];anims={};constructor(t,n,s={}){this.tex=t,n&&(this.frames=n),this.anims=s}static from(t,n={}){return typeof t=="string"?T.fromURL(t,n):Promise.resolve(T.fromImage(t,n))}static fromImage(t,n={}){return new T(b.fromImage(t,n),Pe(n.sliceX||1,n.sliceY||1),n.anims??{})}static fromURL(t,n={}){return Ae(t).then(s=>T.fromImage(s,n))}}u(T,"SpriteData");class R{buf;constructor(t){this.buf=t}static fromArrayBuffer(t){return new Promise((n,s)=>C.ctx.decodeAudioData(t,n,s)).then(n=>new R(n))}static fromURL(t){return Jt(t)?R.fromArrayBuffer(cr(t)):st(t).then(n=>R.fromArrayBuffer(n))}}u(R,"SoundData");let C=(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.connect(e.destination);let n=new R(nn(e));return e.decodeAudioData(Zt.buffer.slice(0)).then(s=>{n.buf=s}).catch(s=>{console.error("Failed to load burp: ",s)}),{ctx:e,masterNode:t,burpSnd:n}})();class O{done=!1;data=null;error=null;onLoadEvents=new W;onErrorEvents=new W;onFinishEvents=new W;constructor(t){t.then(n=>{this.data=n,this.onLoadEvents.trigger(n)}).catch(n=>{if(this.error=n,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(n);else throw n}).finally(()=>{this.onFinishEvents.trigger(),this.done=!0})}static loaded(t){let n=new O(Promise.resolve(t));return n.data=t,n.done=!0,n}onLoad(t){return this.onLoadEvents.add(t),this}onError(t){return this.onErrorEvents.add(t),this}onFinish(t){return this.onFinishEvents.add(t),this}then(t){return this.onLoad(t)}catch(t){return this.onError(t)}finally(t){return this.onFinish(t)}}u(O,"Asset");class M{assets=new Map;lastUID=0;add(t,n){let s=t??this.lastUID+++"",h=new O(n);return this.assets.set(s,h),h}addLoaded(t,n){let s=t??this.lastUID+++"",h=O.loaded(n);this.assets.set(s,h)}get(t){return this.assets.get(t)}progress(){if(this.assets.size===0)return 1;let t=0;return this.assets.forEach(n=>{n.done&&t++}),t/this.assets.size}}u(M,"AssetBucket");let U={urlPrefix:"",sprites:new M,fonts:new M,bitmapFonts:new M,sounds:new M,shaders:new M,custom:new M,loaded:!1},g={ev:new ue,objEvents:new ue,root:Rn([]),gravity:0,scenes:{},logs:[],cam:{pos:null,scale:f(1),angle:0,shake:0,transform:new A}};function le(e){return U.custom.add(null,e)}u(le,"load");function I(){let e=[U.sprites,U.sounds,U.shaders,U.fonts,U.bitmapFonts,U.custom];return e.reduce((t,n)=>t+n.progress(),0)/e.length}u(I,"loadProgress");function Y(e){return e!==void 0&&(U.urlPrefix=e),U.urlPrefix}u(Y,"loadRoot");function Ce(e){let t=U.urlPrefix+e;return fetch(t).then(n=>{if(!n.ok)throw new Error(`Failed to fetch ${t}`);return n})}u(Ce,"fetchURL");function Te(e){return Ce(e).then(t=>t.json())}u(Te,"fetchJSON");function it(e){return Ce(e).then(t=>t.text())}u(it,"fetchText");function st(e){return Ce(e).then(t=>t.arrayBuffer())}u(st,"fetchArrayBuffer");function Ae(e){let t=new Image;return t.crossOrigin="anonymous",t.src=Jt(e)?e:U.urlPrefix+e,new Promise((n,s)=>{t.onload=()=>n(t),t.onerror=()=>s(new Error(`Failed to load image from "${e}"`))})}u(Ae,"loadImg");function xt(e,t){let n=new FontFace(e,typeof t=="string"?`url(${t})`:t);return document.fonts.add(n),U.fonts.add(e,n.load().catch(()=>{throw new Error(`Failed to load font from "${t}"`)}))}u(xt,"loadFont");function Oe(e,t,n,s,h={}){return U.bitmapFonts.add(e,Ae(t).then(o=>Vr(b.fromImage(o,h),n,s,h.chars??br)))}u(Oe,"loadBitmapFont");function Pe(e=1,t=1,n=0,s=0,h=1,o=1){let l=[],d=h/e,m=o/t;for(let w=0;w<t;w++)for(let v=0;v<e;v++)l.push(new j(n+v*d,s+w*m,d,m));return l}u(Pe,"slice");function rn(e,t){return le(typeof t=="string"?new Promise((n,s)=>{Te(t).then(h=>{rn(e,h).then(n).catch(s)})}):T.from(e).then(n=>{let s={};for(let h in t){let o=n.tex.width,l=n.tex.height,d=t[h],m=new T(n.tex,Pe(d.sliceX,d.sliceY,d.x/o,d.y/l,d.width/o,d.height/l),d.anims);U.sprites.addLoaded(h,m),s[h]=m}return s}))}u(rn,"loadSpriteAtlas");function Re(e,t,n={sliceX:1,sliceY:1,anims:{}}){return U.sprites.add(e,typeof t=="string"?T.fromURL(t,n):Promise.resolve(T.fromImage(t,n)))}u(Re,"loadSprite");function Or(e,t){return U.sprites.add(e,new Promise(async n=>{let s=typeof t=="string"?await Te(t):t,h=await Promise.all(s.frames.map(Ae)),o=document.createElement("canvas");o.width=s.width,o.height=s.height*s.frames.length;let l=o.getContext("2d");h.forEach((m,w)=>{l.drawImage(m,0,w*s.height)});let d=await Re(null,o,{sliceY:s.frames.length,anims:s.anims});n(d)}))}u(Or,"loadPedit");function Pr(e,t,n){return U.sprites.add(e,new Promise(async s=>{let h=await Re(null,t),o=typeof n=="string"?await Te(n):n,l=o.meta.size;h.frames=o.frames.map(d=>new j(d.frame.x/l.w,d.frame.y/l.h,d.frame.w/l.w,d.frame.h/l.h));for(let d of o.meta.frameTags)d.from===d.to?h.anims[d.name]=d.from:h.anims[d.name]={from:d.from,to:d.to,speed:10,loop:!0,pingpong:d.direction==="pingpong"};s(h)}))}u(Pr,"loadAseprite");function Rr(e,t,n,s=!1){return U.shaders.add(e,new Promise((h,o)=>{let l=u(d=>d?it(d):new Promise(m=>m(null)),"resolveUrl");if(s)Promise.all([l(t),l(n)]).then(([d,m])=>{h(St(d,m))}).catch(o);else try{h(St(t,n))}catch(d){o(d)}}))}u(Rr,"loadShader");function Dr(e,t){return U.sounds.add(e,typeof t=="string"?R.fromURL(t):R.fromArrayBuffer(t))}u(Dr,"loadSound");function Mr(e="bean"){return Re(e,fr)}u(Mr,"loadBean");function sn(e){return U.sprites.get(e)}u(sn,"getSprite");function on(e){return U.sounds.get(e)}u(on,"getSound");function Fr(e){return U.fonts.get(e)}u(Fr,"getFont");function an(e){return U.bitmapFonts.get(e)}u(an,"getBitmapFont");function un(e){return U.shaders.get(e)}u(un,"getShader");function cn(e){if(typeof e=="string"){let t=sn(e);if(t)return t;if(I()<1)return null;throw new Error(`Sprite not found: ${e}`)}else{if(e instanceof T)return O.loaded(e);if(e instanceof O)return e;throw new Error(`Invalid sprite: ${e}`)}}u(cn,"resolveSprite");function Br(e){if(typeof e=="string"){let t=on(e);if(t)return t.data?t.data:t;if(I()<1)return null;throw new Error(`Sound not found: ${e}`)}else{if(e instanceof R)return e;if(e instanceof O)return e.data?e.data:e;throw new Error(`Invalid sound: ${e}`)}}u(Br,"resolveSound");function Lr(e){if(!e)return p.defShader;if(typeof e=="string"){let t=un(e);if(t)return t.data?t.data:t;if(I()<1)return null;throw new Error(`Shader not found: ${e}`)}else if(e instanceof O)return e.data?e.data:e;return e}u(Lr,"resolveShader");function ln(e){if(!e)return ln(i.font??ks);if(typeof e=="string"){let t=an(e);if(t)return t.data?t.data:t;if(document.fonts.check(`${Er}px ${e}`))return e;if(I()<1)return null;throw new Error(`Font not found: ${e}`)}else if(e instanceof O)return e.data?e.data:e;return e}u(ln,"resolveFont");function Ir(e){return e!==void 0&&(C.masterNode.gain.value=ne(e,vr,yr)),C.masterNode.gain.value}u(Ir,"volume");function Ye(e,t={loop:!1,volume:1,speed:1,detune:0,seek:0}){let n=Br(e);if(n instanceof O){let y=Ye(new R(nn(C.ctx))),L=u(P=>{let q=Ye(P,t);for(let z in q)y[z]=q[z]},"doPlay");return n.onLoad(L),y}else if(n===null){let y=Ye(new R(nn(C.ctx)));return jt(()=>{}),y}let s=C.ctx,h=!1,o=s.createBufferSource();o.buffer=n.buf,o.loop=!!t.loop;let l=s.createGain();o.connect(l),l.connect(C.masterNode);let d=t.seek??0;o.start(0,d);let m=s.currentTime-d,w=null,v={stop(){h||(this.pause(),m=s.currentTime)},play(y){if(!h)return;let L=o;o=s.createBufferSource(),o.buffer=L.buffer,o.loop=L.loop,o.playbackRate.value=L.playbackRate.value,o.detune&&(o.detune.value=L.detune.value),o.connect(l);let P=y??this.time();o.start(0,P),m=s.currentTime-P,h=!1,w=null},pause(){h||(o.stop(),h=!0,w=s.currentTime)},isPaused(){return h},isStopped(){return h},speed(y){return y!==void 0&&(o.playbackRate.value=ne(y,Gs,Ns)),o.playbackRate.value},detune(y){return o.detune?(y!==void 0&&(o.detune.value=ne(y,js,_s)),o.detune.value):0},volume(y){return y!==void 0&&(l.gain.value=ne(y,vr,yr)),l.gain.value},loop(){o.loop=!0},unloop(){o.loop=!1},duration(){return n.buf.duration},time(){return h?w-m:s.currentTime-m}};return v.speed(t.speed),v.detune(t.detune),v.volume(t.volume),v}u(Ye,"play");function hn(e){return Ye(C.burpSnd,e)}u(hn,"burp");function St(e=Wt,t=en){let n=Hs.replace("{{user}}",e??Wt),s=$s.replace("{{user}}",t??en),h=c.createShader(c.VERTEX_SHADER),o=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(h,n),c.shaderSource(o,s),c.compileShader(h),c.compileShader(o);let l=c.createProgram();if(r.push(()=>c.deleteProgram(l)),c.attachShader(l,h),c.attachShader(l,o),c.bindAttribLocation(l,0,"a_pos"),c.bindAttribLocation(l,1,"a_uv"),c.bindAttribLocation(l,2,"a_color"),c.linkProgram(l),!c.getProgramParameter(l,c.LINK_STATUS)){let d=u(y=>{let L=/^ERROR:\s0:(?<line>\d+):\s(?<msg>.+)/,P=y.match(L);return{line:Number(P.groups.line),msg:P.groups.msg.replace(/\n\0$/,"")}},"formatShaderError"),m=c.getShaderInfoLog(h),w=c.getShaderInfoLog(o),v="";if(m){let y=d(m);v+=`Vertex shader line ${y.line-14}: ${y.msg}`}if(w){let y=d(w);v+=`Fragment shader line ${y.line-14}: ${y.msg}`}throw new Error(v)}return c.deleteShader(h),c.deleteShader(o),{bind(){c.useProgram(l)},unbind(){c.useProgram(null)},free(){c.deleteProgram(l)},send(d){for(let m in d){let w=d[m],v=c.getUniformLocation(l,m);typeof w=="number"?c.uniform1f(v,w):w instanceof A?c.uniformMatrix4fv(v,!1,new Float32Array(w.m)):w instanceof x?c.uniform3f(v,w.r,w.g,w.b):w instanceof _e?c.uniform3f(v,w.x,w.y,w.z):w instanceof D&&c.uniform2f(v,w.x,w.y)}}}}u(St,"makeShader");function Vr(e,t,n,s){let h=e.width/t,o={},l=s.split("").entries();for(let[d,m]of l)o[m]=new j(d%h*t,Math.floor(d/h)*n,t,n);return{tex:e,map:o,size:n}}u(Vr,"makeFont");function Ct(e,t,n,s=p.defTex,h=p.defShader,o={}){let l=Lr(h);if(!(!l||l instanceof O)){(s!==p.curTex||l!==p.curShader||!Xt(p.curUniform,o)||p.vqueue.length+e.length*Et>Sr||p.iqueue.length+t.length>Cr)&&he();for(let d of e){let m=n?p.transform:g.cam.transform.mult(p.transform),w=jr(m.multVec2(d.pos.xy()));p.vqueue.push(w.x,w.y,d.pos.z,d.uv.x,d.uv.y,d.color.r/255,d.color.g/255,d.color.b/255,d.opacity)}for(let d of t)p.iqueue.push(d+p.vqueue.length/Et-e.length);p.curTex=s,p.curShader=l,p.curUniform=o}}u(Ct,"drawRaw");function he(){!p.curTex||!p.curShader||p.vqueue.length===0||p.iqueue.length===0||(c.bindBuffer(c.ARRAY_BUFFER,p.vbuf),c.bufferSubData(c.ARRAY_BUFFER,0,new Float32Array(p.vqueue)),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,p.ibuf),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(p.iqueue)),p.curShader.bind(),p.curShader.send(p.curUniform),p.curTex.bind(),c.drawElements(c.TRIANGLES,p.iqueue.length,c.UNSIGNED_SHORT,0),p.curTex.unbind(),p.curShader.unbind(),c.bindBuffer(c.ARRAY_BUFFER,null),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),p.vqueue=[],p.iqueue=[],p.drawCalls++)}u(he,"flush");function Gr(){Kr(),c.clear(c.COLOR_BUFFER_BIT),i.background||ce(()=>{Me({width:_(),height:B(),quad:new j(0,0,_()/Ur,B()/Ur),tex:p.bgTex,fixed:!0})}),p.drawCalls=0,p.transformStack=[],p.transform=new A}u(Gr,"frameStart");function Nr(){he(),p.lastDrawCalls=p.drawCalls}u(Nr,"frameEnd");function jr(e){return f(e.x/_()*2-1,-e.y/B()*2+1)}u(jr,"screen2ndc");function _r(e){p.transform=e.clone()}u(_r,"pushMatrix");function V(...e){if(e[0]===void 0)return;let t=f(...e);t.x===0&&t.y===0||(p.transform=p.transform.translate(t))}u(V,"pushTranslate");function De(...e){if(e[0]===void 0)return;let t=f(...e);t.x===1&&t.y===1||(p.transform=p.transform.scale(t))}u(De,"pushScale");function kr(e){!e||(p.transform=p.transform.rotateX(e))}u(kr,"pushRotateX");function qr(e){!e||(p.transform=p.transform.rotateY(e))}u(qr,"pushRotateY");function be(e){!e||(p.transform=p.transform.rotateZ(e))}u(be,"pushRotateZ");let zr=be;function ee(){p.transformStack.push(p.transform.clone())}u(ee,"pushTransform");function X(){p.transformStack.length>0&&(p.transform=p.transformStack.pop())}u(X,"popTransform");function Me(e){if(e.width===void 0||e.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,h=rt(e.anchor||vt).scale(f(t,n).scale(-.5)),o=e.quad||new j(0,0,1,1),l=e.color||E(255,255,255),d=e.opacity??1,m=e.tex?xr/e.tex.width:0,w=e.tex?xr/e.tex.height:0,v=o.x+m,y=o.y+w,L=o.w-m*2,P=o.h-w*2;ee(),V(e.pos),be(e.angle),De(e.scale),V(h),Ct([{pos:ge(-t/2,n/2,0),uv:f(e.flipX?v+L:v,e.flipY?y:y+P),color:l,opacity:d},{pos:ge(-t/2,-n/2,0),uv:f(e.flipX?v+L:v,e.flipY?y+P:y),color:l,opacity:d},{pos:ge(t/2,-n/2,0),uv:f(e.flipX?v:v+L,e.flipY?y+P:y),color:l,opacity:d},{pos:ge(t/2,n/2,0),uv:f(e.flipX?v:v+L,e.flipY?y:y+P),color:l,opacity:d}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform),X()}u(Me,"drawUVQuad");function Hr(e){if(!e.tex)throw new Error('drawTexture() requires property "tex".');let t=e.quad??new j(0,0,1,1),n=e.tex.width*t.w,s=e.tex.height*t.h,h=f(1);if(e.tiled){let o=Math.ceil((e.width||n)/n),l=Math.ceil((e.height||s)/s),m=rt(e.anchor||vt).add(f(1,1)).scale(.5).scale(o*n,l*s);for(let w=0;w<o;w++)for(let v=0;v<l;v++)Me({...e,pos:(e.pos||f(0)).add(f(n*w,s*v)).sub(m),scale:h.scale(e.scale||f(1)),tex:e.tex,quad:t,width:n,height:s,anchor:"topleft"})}else e.width&&e.height?(h.x=e.width/n,h.y=e.height/s):e.width?(h.x=e.width/n,h.y=h.x):e.height&&(h.y=e.height/s,h.x=h.y),Me({...e,scale:h.scale(e.scale||f(1)),tex:e.tex,quad:t,width:n,height:s})}u(Hr,"drawTexture");function dn(e){if(!e.sprite)throw new Error('drawSprite() requires property "sprite"');let t=cn(e.sprite);if(!t||!t.data)return;let n=t.data.frames[e.frame??0];if(!n)throw new Error(`Frame not found: ${e.frame??0}`);Hr({...e,tex:t.data.tex,quad:n.scale(e.quad||new j(0,0,1,1))})}u(dn,"drawSprite");function Xe(e,t,n,s,h,o=1){s=fe(s%360),h=fe(h%360),h<=s&&(h+=Math.PI*2);let l=Math.ceil(Math.max(Math.sqrt(t+n)*3*(o||1),16)),d=(h-s)/l,m=[];for(let w=s;w<h;w+=d)m.push(e.add(t*Math.cos(w),n*Math.sin(w)));return m.push(e.add(t*Math.cos(h),n*Math.sin(h))),m}u(Xe,"getArcPts");function K(e){if(e.width===void 0||e.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,h=rt(e.anchor||vt).add(1,1).scale(f(t,n).scale(-.5)),o=[f(0,0),f(t,0),f(t,n),f(0,n)];if(e.radius){let l=Math.min(Math.min(t,n)/2,e.radius);o=[f(l,0),f(t-l,0),...Xe(f(t-l,l),l,l,270,360),f(t,l),f(t,n-l),...Xe(f(t-l,n-l),l,l,0,90),f(t-l,n),f(l,n),...Xe(f(l,n-l),l,l,90,180),f(0,n-l),f(0,l),...Xe(f(l,l),l,l,180,270)]}ye({...e,offset:h,pts:o,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}})}u(K,"drawRect");function Ke(e){let{p1:t,p2:n}=e;if(!t||!n)throw new Error('drawLine() requires properties "p1" and "p2".');let s=e.width||1,h=n.sub(t).unit().normal().scale(s*.5),o=[t.sub(h),t.add(h),n.add(h),n.sub(h)].map(l=>({pos:ge(l.x,l.y,0),uv:f(0),color:e.color??x.WHITE,opacity:e.opacity??1}));Ct(o,[0,1,3,1,2,3],e.fixed,p.defTex,e.shader,e.uniform)}u(Ke,"drawLine");function fn(e){let t=e.pts;if(!t)throw new Error('drawLines() requires property "pts".');if(!(t.length<2))if(e.radius&&t.length>=3){let n=t[0].dist(t[1]);for(let h=1;h<t.length-1;h++)n=Math.min(t[h].dist(t[h+1]),n);let s=Math.min(e.radius,n/2);Ke({...e,p1:t[0],p2:t[1]});for(let h=1;h<t.length-2;h++){let o=t[h],l=t[h+1];Ke({...e,p1:o,p2:l})}Ke({...e,p1:t[t.length-2],p2:t[t.length-1]})}else for(let n=0;n<t.length-1;n++)Ke({...e,p1:t[n],p2:t[n+1]}),e.join!=="none"&&ve({...e,pos:t[n],radius:e.width/2})}u(fn,"drawLines");function mn(e){if(!e.p1||!e.p2||!e.p3)throw new Error('drawPolygon() requires properties "p1", "p2" and "p3".');return ye({...e,pts:[e.p1,e.p2,e.p3]})}u(mn,"drawTriangle");function ve(e){if(!e.radius)throw new Error('drawCircle() requires property "radius".');e.radius!==0&&pn({...e,radiusX:e.radius,radiusY:e.radius,angle:0})}u(ve,"drawCircle");function pn(e){if(e.radiusX===void 0||e.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(e.radiusX===0||e.radiusY===0)return;let t=e.start??0,n=e.end??360,s=Xe(f(0),e.radiusX,e.radiusY,t,n,e.resolution);s.unshift(f(0));let h={...e,pts:s,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(s.length-1).fill(e.gradient[1])]}:{}};if(n-t>=360&&e.outline){e.fill!==!1&&ye({...h,outline:null}),ye({...h,pts:s.slice(1),fill:!1});return}ye(h)}u(pn,"drawEllipse");function ye(e){if(!e.pts)throw new Error('drawPolygon() requires property "pts".');let t=e.pts.length;if(!(t<3)){if(ee(),V(e.pos),De(e.scale),be(e.angle),V(e.offset),e.fill!==!1){let n=e.color??x.WHITE,s=e.pts.map((o,l)=>({pos:ge(o.x,o.y,0),uv:f(0,0),color:e.colors?e.colors[l]??n:n,opacity:e.opacity??1})),h=[...Array(t-2).keys()].map(o=>[0,o+1,o+2]).flat();Ct(s,e.indices??h,e.fixed,p.defTex,e.shader,e.uniform)}e.outline&&fn({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity}),X()}}u(ye,"drawPolygon");function gn(e,t,n){he(),c.clear(c.STENCIL_BUFFER_BIT),c.enable(c.STENCIL_TEST),c.stencilFunc(c.NEVER,1,255),c.stencilOp(c.REPLACE,c.REPLACE,c.REPLACE),t(),he(),c.stencilFunc(n,1,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),e(),he(),c.disable(c.STENCIL_TEST)}u(gn,"drawStenciled");function $r(e,t){gn(e,t,c.EQUAL)}u($r,"drawMasked");function Yr(e,t){gn(e,t,c.NOTEQUAL)}u(Yr,"drawSubtracted");function wn(){return(p.viewport.width+p.viewport.height)/(p.width+p.height)}u(wn,"getViewportScale");function ce(e){he();let t=p.width,n=p.height;p.width=p.viewport.width,p.height=p.viewport.height,e(),he(),p.width=t,p.height=n}u(ce,"drawUnscaled");function bn(e,t){t.pos&&(e.pos=e.pos.add(t.pos)),t.scale&&(e.scale=e.scale.scale(f(t.scale))),t.angle&&(e.angle+=t.angle),t.color&&(e.color=e.color.mult(t.color)),t.opacity&&(e.opacity*=t.opacity)}u(bn,"applyCharTransform");let vn=/\[(?<text>[^\]]*)\]\.(?<style>[\w\.]+)+/g;function Xr(e){let t={},n=e.replace(vn,"$1"),s=0;for(let h of e.matchAll(vn)){let o=h.groups.style.split("."),l=h.index-s;for(let d=l;d<h.index+h.groups.text.length;d++)t[d]={localIdx:d-l,styles:o};s+=3+h.groups.style.length}return{charStyleMap:t,text:n}}u(Xr,"compileStyledText");let Tt={};function Ue(e){if(e.text===void 0)throw new Error('formatText() requires property "text".');let t=ln(e.font);if(e.text===""||t instanceof O||!t)return{width:0,height:0,chars:[],opt:e};let{charStyleMap:n,text:s}=Xr(e.text+""),h=s.split("");if(t instanceof FontFace||typeof t=="string"){let k=t instanceof FontFace?t.family:t,S=Tt[k]??{font:{tex:new b(Ut,Ut,{filter:"linear"}),map:{},size:Er},cursor:f(0)};Tt[k]||(Tt[k]=S),t=S.font;for(let N of h)if(!S.font.map[N]){let re=a.canvas2.getContext("2d");re.font=`${t.size}px ${k}`,re.clearRect(0,0,a.canvas2.width,a.canvas2.height),re.textBaseline="top",re.textAlign="left",re.fillStyle="rgb(255, 255, 255)",re.fillText(N,0,0);let et=re.measureText(N),Ge=Math.ceil(et.width),Ne=re.getImageData(0,0,Ge,t.size);if(S.cursor.x+Ge>Ut&&(S.cursor.x=0,S.cursor.y+=t.size,S.cursor.y>Ut))throw new Error("Font atlas exceeds character limit");t.tex.update(S.cursor.x,S.cursor.y,Ne),t.map[N]=new j(S.cursor.x,S.cursor.y,Ge,t.size),S.cursor.x+=Ge}}let o=e.size||t.size,l=f(e.scale??1).scale(o/t.size),d=e.lineSpacing??0,m=e.letterSpacing??0,w=0,v=0,y=0,L=[],P=[],q=0,z=null,xe=null;for(;q<h.length;){let k=h[q];if(k===`
`)y+=o+d,L.push({width:w-m,chars:P}),z=null,xe=null,w=0,P=[];else{let S=t.map[k];if(S){let N=S.w*l.x;e.width&&w+N>e.width&&(y+=o+d,z!=null&&(q-=P.length-z,k=h[q],S=t.map[k],N=S.w*l.x,P=P.slice(0,z-1),w=xe),z=null,xe=null,L.push({width:w-m,chars:P}),w=0,P=[]),P.push({tex:t.tex,width:S.w,height:S.h,quad:new j(S.x/t.tex.width,S.y/t.tex.height,S.w/t.tex.width,S.h/t.tex.height),ch:k,pos:f(w,y),opacity:e.opacity??1,color:e.color??x.WHITE,scale:f(l),angle:0}),k===" "&&(z=P.length,xe=w),w+=N,v=Math.max(v,w),w+=m}}q++}L.push({width:w-m,chars:P}),y+=o,e.width&&(v=e.width);let J=[];for(let k of L){let S=(v-k.width)*Zs(e.align??"left");for(let N of k.chars){let re=t.map[N.ch],et=J.length,Ge=new D(re.w*l.x*.5,re.h*l.y*.5);if(N.pos=N.pos.add(S,0).add(Ge),e.transform){let Ne=typeof e.transform=="function"?e.transform(et,N.ch):e.transform;Ne&&bn(N,Ne)}if(n[et]){let{styles:Ne,localIdx:ws}=n[et];for(let bs of Ne){let qt=e.styles[bs],$n=typeof qt=="function"?qt(ws,N.ch):qt;$n&&bn(N,$n)}}J.push(N)}}return{width:v,height:y,chars:J,opt:e}}u(Ue,"formatText");function ot(e){Ee(Ue(e))}u(ot,"drawText");function Ee(e){ee(),V(e.opt.pos),be(e.opt.angle),V(rt(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(t=>{Me({tex:t.tex,width:t.width,height:t.height,pos:t.pos,scale:t.scale,angle:t.angle,color:t.color,opacity:t.opacity,quad:t.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),X()}u(Ee,"drawFormattedText");function Kr(){if(a.stretchToParent&&!Ft()){let h=a.canvas.parentElement.offsetWidth,o=a.canvas.parentElement.offsetHeight;if(h!==a.lastParentWidth||o!==a.lastParentHeight){a.canvas.width=h*a.pixelDensity,a.canvas.height=o*a.pixelDensity,a.canvas.style.width=h+"px",a.canvas.style.height=o+"px";let l=_(),d=B();g.ev.onOnce("frameEnd",()=>{g.ev.trigger("resize",l,d,_(),B())})}a.lastParentWidth=h,a.lastParentHeight=o}let e=a.pixelDensity,t=c.drawingBufferWidth/e,n=c.drawingBufferHeight/e;if(Ft()){let h=window.innerWidth,o=window.innerHeight,l=h/o,d=t/n;if(l>d){let m=window.innerHeight*d;p.viewport={x:(h-m)/2,y:0,width:m,height:o}}else{let m=window.innerWidth/d;p.viewport={x:0,y:(o-m)/2,width:h,height:m}}return}if(i.letterbox){if(!i.width||!i.height)throw new Error("Letterboxing requires width and height defined.");let h=t/n,o=i.width/i.height;if(h>o){i.stretch||(p.width=n*o,p.height=n);let l=n*o,d=n,m=(t-l)/2;c.scissor(m*e,0,l*e,d*e),c.viewport(m*e,0,l*e,n*e),p.viewport={x:m,y:0,width:l,height:n}}else{i.stretch||(p.width=t,p.height=t/o);let l=t,d=t/o,m=(n-d)/2;c.scissor(0,m*e,l*e,d*e),c.viewport(0,m*e,t*e,d*e),p.viewport={x:0,y:m,width:t,height:d}}return}if(i.stretch){if(!i.width||!i.height)throw new Error("Stretching requires width and height defined.");c.viewport(0,0,t*e,n*e),p.viewport={x:0,y:0,width:t,height:n};return}let s=i.scale??1;p.width=t/s,p.height=n/s,c.viewport(0,0,t*e,n*e),p.viewport={x:0,y:0,width:t,height:n}}u(Kr,"updateViewport");function _(){return p.width}u(_,"width");function B(){return p.height}u(B,"height");let $={},Qe={},Fe={};function at(e){return f((e.x-p.viewport.x)*_()/p.viewport.width,(e.y-p.viewport.y)*B()/p.viewport.height)}u(at,"windowToContent");function Qr(e){return f(e.x*p.viewport.width/p.width,e.y*p.viewport.height/p.height)}u(Qr,"contentToView");function At(e,t){let n=at(f(e,t));a.mouseStarted&&(a.mouseDeltaPos=n.sub(a.mousePos)),a.mousePos=n,a.mouseStarted=!0,a.isMouseMoved=!0}u(At,"setMousePos"),$.mousemove=e=>{At(e.offsetX,e.offsetY)},$.mousedown=e=>{let t=wr[e.button];t&&(a.mouseStates[t]="pressed")},$.mouseup=e=>{let t=wr[e.button];t&&(a.mouseStates[t]="released")},$.keydown=e=>{let t=gr[e.key]||e.key.toLowerCase();Vs.includes(t)&&e.preventDefault(),t.length===1&&a.charInputted.push(e.key),t==="space"&&a.charInputted.push(" "),e.repeat?(a.isKeyPressedRepeat=!0,a.keyStates[t]="rpressed"):(a.isKeyPressed=!0,a.keyStates[t]="pressed"),a.numKeyDown++},$.keyup=e=>{let t=gr[e.key]||e.key.toLowerCase();a.keyStates[t]="released",a.isKeyReleased=!0,a.numKeyDown--},$.touchstart=e=>{e.preventDefault();let t=[...e.changedTouches];t.forEach(n=>{g.ev.trigger("onTouchStart",at(f(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(At(t[0].clientX,t[0].clientY),a.mouseStates.left="pressed")},$.touchmove=e=>{e.preventDefault();let t=[...e.changedTouches];t.forEach(n=>{g.ev.trigger("onTouchMove",at(f(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&At(t[0].clientX,t[0].clientY)},$.touchend=e=>{[...e.changedTouches].forEach(n=>{g.ev.trigger("onTouchEnd",at(f(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(a.mouseStates.left="released")},$.touchcancel=()=>{i.touchToMouse!==!1&&(a.mouseStates.left="released")},$.contextmenu=function(e){e.preventDefault()},Qe.visibilitychange=()=>{switch(document.visibilityState){case"visible":a.skipTime=!0,F.paused||C.ctx.resume();break;case"hidden":C.ctx.suspend();break}},Fe.error=e=>{e.error?_t(e.error):_t(new Error(e.message))},Fe.unhandledrejection=e=>_t(e.reason);for(let e in $)a.canvas.addEventListener(e,$[e]);for(let e in Qe)document.addEventListener(e,Qe[e]);for(let e in Fe)window.addEventListener(e,Fe[e]);function te(){return a.mousePos.clone()}u(te,"mousePos");function yn(){return a.mouseDeltaPos.clone()}u(yn,"mouseDeltaPos");function Be(e="left"){return a.mouseStates[e]==="pressed"}u(Be,"isMousePressed");function Ot(e="left"){return a.mouseStates[e]==="pressed"||a.mouseStates[e]==="down"}u(Ot,"isMouseDown");function Je(e="left"){return a.mouseStates[e]==="released"}u(Je,"isMouseReleased");function Un(){return a.isMouseMoved}u(Un,"isMouseMoved");function Pt(e){return e===void 0?a.isKeyPressed:a.keyStates[e]==="pressed"}u(Pt,"isKeyPressed");function Rt(e){return e===void 0?a.isKeyPressedRepeat:a.keyStates[e]==="pressed"||a.keyStates[e]==="rpressed"}u(Rt,"isKeyPressedRepeat");function En(e){return e===void 0?a.numKeyDown>0:a.keyStates[e]==="pressed"||a.keyStates[e]==="rpressed"||a.keyStates[e]==="down"}u(En,"isKeyDown");function Dt(e){return e===void 0?a.isKeyReleased:a.keyStates[e]==="released"}u(Dt,"isKeyReleased");function xn(e){return a.virtualButtonStates[e]==="pressed"}u(xn,"isVirtualButtonPressed");function Sn(e){return a.virtualButtonStates[e]==="pressed"||a.virtualButtonStates[e]==="down"}u(Sn,"isVirtualButtonDown");function Cn(e){return a.virtualButtonStates[e]==="released"}u(Cn,"isVirtualButtonReleased");function Jr(){return[...a.charInputted]}u(Jr,"charInputted");function Mt(){return a.time}u(Mt,"time");function Zr(){return a.canvas.toDataURL()}u(Zr,"screenshot");function Tn(e){return e&&(a.canvas.style.cursor=e),a.canvas.style.cursor}u(Tn,"setCursor");function Wr(e=!0){e?Ks(a.canvas):Qs()}u(Wr,"setFullscreen");function Ft(){return Boolean(Js())}u(Ft,"isFullscreen");function An(){return a.isTouchScreen}u(An,"isTouchScreen");let F={inspect:!1,timeScale:1,showLog:!0,fps:()=>a.fpsCounter.fps,numFrames:()=>a.numFrames,stepFrame:qn,drawCalls:()=>p.drawCalls,clearLog:()=>g.logs=[],log:e=>{let t=i.logMax??zs;g.logs.unshift(`${`[${Mt().toFixed(2)}].time `}[${e?.toString?e.toString():e}].${e instanceof Error?"error":"info"}`),g.logs.length>t&&(g.logs=g.logs.slice(0,t))},error:e=>F.log(new Error(e.toString?e.toString():e)),curRecording:null,get paused(){return a.paused},set paused(e){a.paused=e,e?C.ctx.suspend():C.ctx.resume()}};function Q(){return a.dt*F.timeScale}u(Q,"dt");function ei(...e){return e.length>0&&(g.cam.pos=f(...e)),g.cam.pos?g.cam.pos.clone():ft()}u(ei,"camPos");function ti(...e){return e.length>0&&(g.cam.scale=f(...e)),g.cam.scale.clone()}u(ti,"camScale");function ni(e){return e!==void 0&&(g.cam.angle=e),g.cam.angle}u(ni,"camRot");function ri(e=12){g.cam.shake=e}u(ri,"shake");function Bt(e){return g.cam.transform.multVec2(e)}u(Bt,"toScreen");function On(e){return g.cam.transform.invert().multVec2(e)}u(On,"toWorld");function Pn(e){let t=new A;return e.pos&&(t=t.translate(e.pos)),e.scale&&(t=t.scale(e.scale)),e.angle&&(t=t.rotateZ(e.angle)),e.parent?t.mult(e.parent.transform):t}u(Pn,"calcTransform");function Rn(e){let t=new Map,n={},s=new ue,h={id:hr(),hidden:!1,paused:!1,transform:new A,children:[],parent:null,add(o){let l=(()=>{if(Array.isArray(o))return Rn(o);if(o.parent)throw new Error("Cannot add a game obj that already has a parent.");return o})();return l.parent=this,l.transform=Pn(l),this.children.push(l),l.trigger("add",this),g.ev.trigger("add",this),l},readd(o){let l=this.children.indexOf(o);return l!==-1&&(this.children.splice(l,1),this.children.push(o)),o},remove(o){let l=this.children.indexOf(o);l!==-1&&(o.parent=null,o.trigger("destroy"),g.ev.trigger("destroy",o),this.children.splice(l,1))},removeAll(o){this.get(o).forEach(l=>this.remove(l))},update(){this.paused||(this.get().forEach(o=>o.update()),this.trigger("update"))},draw(){this.hidden||(ee(),V(this.pos),De(this.scale),be(this.angle),this.trigger("draw"),this.get().forEach(o=>o.draw()),X())},drawInspect(){this.hidden||(ee(),V(this.pos),De(this.scale),be(this.angle),this.get().forEach(o=>o.drawInspect()),this.trigger("drawInspect"),X())},use(o){if(!o)return;if(typeof o=="string")return this.use({id:o});o.id&&(this.unuse(o.id),t.set(o.id,{cleanups:[]}));let l=o.id?t.get(o.id):n,d=o.id?l.cleanups:[],m=u(()=>{if(o.require){for(let w of o.require)if(!this.c(w))throw new Error(`Component "${o.id}" requires component "${w}"`)}},"checkDeps");o.destroy&&d.push(o.destroy),o.require&&!this.exists()&&l.cleanups&&d.push(this.on("add",m));for(let w in o)if(!Ys.has(w)){if(typeof o[w]=="function"){let v=o[w].bind(this);if(Xs.has(w)){d.push(this.on(w,v)),l[w]=v;continue}else l[w]=v}else l[w]=o[w];if(this[w]===void 0)Object.defineProperty(this,w,{get:()=>l[w],set:v=>l[w]=v,configurable:!0,enumerable:!0});else throw new Error(`Duplicate component property: "${w}"`)}this.exists()&&(m(),o.add&&o.add.call(this))},unuse(o){if(t.has(o)){let l=t.get(o);l.cleanups.forEach(d=>d.cancel());for(let d in l)delete l[d]}t.delete(o)},c(o){return t.get(o)},get(o){return this.children.filter(l=>o?l.is(o):!0).sort((l,d)=>(l.z??0)-(d.z??0))},getAll(o){return this.children.sort((l,d)=>(l.z??0)-(d.z??0)).flatMap(l=>[l,...l.getAll(o)]).filter(l=>o?l.is(o):!0)},isAncestorOf(o){return o.parent?o.parent===this||this.isAncestorOf(o.parent):!1},exists(){return g.root.isAncestorOf(this)},is(o){if(o==="*")return!0;if(Array.isArray(o)){for(let l of o)if(!this.c(l))return!1;return!0}else return this.c(o)!=null},on(o,l){return s.on(o,l.bind(this))},trigger(o,...l){s.trigger(o,...l),g.objEvents.trigger(o,this,...l)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let o={};for(let[l,d]of t)o[l]=d.inspect?d.inspect():null;return o},onAdd(o){return this.on("add",o)},onUpdate(o){return this.on("update",o)},onDraw(o){return this.on("draw",o)},onDestroy(o){return this.on("destroy",o)},clearEvents(){s.clear()}};for(let o of e)h.use(o);return h}u(Rn,"make");function Le(e,t,n){return g.objEvents[e]||(g.objEvents[e]=new Se),g.objEvents.on(e,(s,...h)=>{s.is(t)&&n(s,...h)})}u(Le,"on");function de(e){return new Promise(t=>{let n=e(()=>{n.cancel(),t()})})}u(de,"promisifyEvent");let ut=u((e,t)=>{if(typeof e=="function"&&t===void 0){let n=We([{update:e}]);return{get paused(){return n.paused},set paused(s){n.paused=s},cancel:()=>n.destroy()}}else{if(typeof e=="string")return Le("update",e,t);if(e===void 0&&t===void 0)return de(ut)}},"onUpdate"),Dn=u((e,t)=>{if(typeof e=="function"&&t===void 0){let n=We([{draw:e}]);return{get paused(){return n.hidden},set paused(s){n.hidden=s},cancel:()=>n.destroy()}}else{if(typeof e=="string")return Le("draw",e,t);if(e===void 0&&t===void 0)return de(Dn)}},"onDraw");function Mn(e,t){if(typeof e=="function"&&t===void 0)return g.ev.on("add",e);if(typeof e=="string")return Le("add",e,t)}u(Mn,"onAdd");function ii(e,t){if(typeof e=="function"&&t===void 0)return g.ev.on("destroy",e);if(typeof e=="string")return Le("destroy",e,t)}u(ii,"onDestroy");function si(e,t,n){return Le("collide",e,(s,h,o)=>h.is(t)&&n(s,h,o))}u(si,"onCollide");function ct(e,t){jn(e).forEach(t),Mn(e,t)}u(ct,"forAllCurrentAndFuture");function oi(e,t){if(typeof e=="function")return Fn(e);{let n=[];return ct(e,s=>{if(!s.area)throw new Error("onClick() requires the object to have area() component");n.push(s.onClick(()=>t(s)))}),lt(n)}}u(oi,"onClick");function ai(e,t){let n=[];return ct(e,s=>{if(!s.area)throw new Error("onHover() requires the object to have area() component");n.push(s.onHover(()=>t(s)))}),lt(n)}u(ai,"onHover");function ui(e,t){let n=[];return ct(e,s=>{if(!s.area)throw new Error("onHoverUpdate() requires the object to have area() component");n.push(s.onHoverUpdate(()=>t(s)))}),lt(n)}u(ui,"onHoverUpdate");function ci(e,t){let n=[];return ct(e,s=>{if(!s.area)throw new Error("onHoverEnd() requires the object to have area() component");n.push(s.onHoverEnd(()=>t(s)))}),lt(n)}u(ci,"onHoverEnd");function Lt(e,t){let n=0,s=[];t&&s.push(t);let h=ut(()=>{n+=Q(),n>=e&&(h.cancel(),s.forEach(o=>o()))});return{paused:h.paused,cancel:h.cancel,onFinish(o){s.push(o)},then(o){return this.onFinish(o),this}}}u(Lt,"wait");function li(e,t){let n=null,s=u(()=>{t(),n=Lt(e,s)},"newF");return s(),{get paused(){return n.paused},set paused(h){n.paused=h},cancel:()=>n.cancel()}}u(li,"loop");function lt(e){return{get paused(){return e[0].paused},set paused(t){e.forEach(n=>n.paused=t)},cancel:()=>e.forEach(t=>t.cancel())}}u(lt,"joinEventControllers");function hi(e,t){return g.ev.on("input",()=>En(e)&&t())}u(hi,"onKeyDown");let se=u((e,t)=>{if(typeof e=="function")return g.ev.on("input",()=>Pt()&&e());if(typeof e=="string"&&typeof t=="function")return g.ev.on("input",()=>Pt(e)&&t(e));if(typeof e=="string"&&t===void 0)return de(se.bind(void 0,e));if(typeof e===void 0&&t===void 0)return de(se)},"onKeyPress"),It=u((e,t)=>{if(typeof e=="function")return g.ev.on("input",()=>Rt()&&e());if(typeof e=="string"&&typeof t=="function")return g.ev.on("input",()=>Rt(e)&&t(e));if(typeof e=="string"&&t===void 0)return de(It.bind(void 0,e));if(typeof e===void 0&&t===void 0)return de(It)},"onKeyPressRepeat"),Vt=u((e,t)=>{if(typeof e=="function")return g.ev.on("input",()=>Dt()&&e());if(typeof e=="string"&&typeof t=="function")return g.ev.on("input",()=>Dt(e)&&t(e));if(typeof e=="string"&&t===void 0)return de(Vt.bind(void 0,e));if(typeof e===void 0&&t===void 0)return de(Vt)},"onKeyRelease");function di(e,t){return typeof e=="function"?g.ev.on("input",()=>Ot()&&e(te())):g.ev.on("input",()=>Ot(e)&&t(te()))}u(di,"onMouseDown");function Fn(e,t){return typeof e=="function"?g.ev.on("input",()=>Be()&&e(te())):g.ev.on("input",()=>Be(e)&&t(te()))}u(Fn,"onMousePress");function fi(e,t){return typeof e=="function"?g.ev.on("input",()=>Je()&&e(te())):g.ev.on("input",()=>Je(e)&&t(te()))}u(fi,"onMouseRelease");function mi(e){return g.ev.on("input",()=>Un()&&e(te(),yn()))}u(mi,"onMouseMove");function pi(e){return g.ev.on("input",()=>Jr().forEach(t=>e(t)))}u(pi,"onCharInput");function gi(e){return g.ev.on("onTouchStart",e)}u(gi,"onTouchStart");function wi(e){return g.ev.on("onTouchMove",e)}u(wi,"onTouchMove");function bi(e){return g.ev.on("onTouchEnd",e)}u(bi,"onTouchEnd");function vi(e,t){return g.ev.on("input",()=>xn(e)&&t())}u(vi,"onVirtualButtonPress");function yi(e,t){return g.ev.on("input",()=>Sn(e)&&t())}u(yi,"onVirtualButtonDown");function Ui(e,t){return g.ev.on("input",()=>Cn(e)&&t())}u(Ui,"onVirtualButtonRelease");function Bn(){se("f1",()=>{F.inspect=!F.inspect}),se("f2",()=>{F.clearLog()}),se("f8",()=>{F.paused=!F.paused}),se("f7",()=>{F.timeScale=Ie(ne(F.timeScale-.2,0,2),1)}),se("f9",()=>{F.timeScale=Ie(ne(F.timeScale+.2,0,2),1)}),se("f10",()=>{F.stepFrame()})}u(Bn,"enterDebugMode");function Ln(){se("b",()=>hn())}u(Ln,"enterBurpMode");function Ei(e){return e!==void 0&&(g.gravity=e),g.gravity}u(Ei,"gravity");function ht(...e){return{id:"pos",pos:f(...e),moveBy(...t){this.pos=this.pos.add(f(...t))},move(...t){this.moveBy(f(...t).scale(Q()))},moveTo(...t){if(typeof t[0]=="number"&&typeof t[1]=="number")return this.moveTo(f(t[0],t[1]),t[2]);let n=t[0],s=t[1];if(s===void 0){this.pos=f(n);return}let h=n.sub(this.pos);if(h.len()<=s*Q()){this.pos=f(n);return}this.move(h.unit().scale(s))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){return this.fixed?this.pos:Bt(this.pos)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){ve({color:E(255,0,0),radius:4/wn()})}}}u(ht,"pos");function dt(...e){return e.length===0?dt(1):{id:"scale",scale:f(...e),scaleTo(...t){this.scale=f(...t)},inspect(){return typeof this.scale=="number"?`${Ie(this.scale,2)}`:`(${Ie(this.scale.x,2)}, ${Ie(this.scale.y,2)})`}}}u(dt,"scale");function xi(e){return{id:"rotate",angle:e??0,rotate(t){this.rotateBy(t*Q())},rotateBy(t){this.angle+=t},inspect(){return`${Math.round(this.angle)}`}}}u(xi,"rotate");function Si(...e){return{id:"color",color:E(...e),inspect(){return this.color.toString()}}}u(Si,"color");function Ie(e,t){return Number(e.toFixed(t))}u(Ie,"toFixed");function Ci(e){return{id:"opacity",opacity:e??1,inspect(){return`${Ie(this.opacity,1)}`},fadeOut(t,n=pe.linear){return kt(this.opacity,0,t,s=>this.opacity=s,n)}}}u(Ci,"opacity");function Gt(e){if(!e)throw new Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return typeof this.anchor=="string"?this.anchor:this.anchor.toString()}}}u(Gt,"anchor");function Ti(e){return{id:"z",z:e,inspect(){return`${this.z}`}}}u(Ti,"z");function Ai(e,t){return{id:"follow",require:["pos"],follow:{obj:e,offset:t??f(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}u(Ai,"follow");function Oi(e,t){let n=typeof e=="number"?D.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(n.scale(t))}}}u(Oi,"move");let Pi=200;function Ri(e={}){let t=e.distance??Pi,n=!1;return{id:"offscreen",require:["pos"],isOffScreen(){let s=Bt(this.pos),h=new G(f(0),_(),B());return!He(h,s)&&h.distToPoint(s)>t},onExitScreen(s){return this.on("exitView",s)},onEnterScreen(s){return this.on("enterView",s)},update(){this.isOffScreen()?(n||(this.trigger("exitView"),n=!0),e.hide&&(this.hidden=!0),e.pause&&(this.paused=!0),e.destroy&&this.destroy()):(n&&(this.trigger("enterView"),n=!1),e.hide&&(this.hidden=!1),e.pause&&(this.paused=!1))},inspect(){return`${this.isOffScreen()}`}}}u(Ri,"offscreen");function Di(e={}){let t=[];return{id:"area",colliding:{},collisionIgnore:e.collisionIgnore??[],add(){this.area.cursor&&t.push(this.onHover(()=>Tn(this.area.cursor))),t.push(this.onCollideUpdate((n,s)=>{this.colliding[n.id]||this.trigger("collide",n,s),this.colliding[n.id]=s}))},update(){for(let n in this.colliding){let s=this.colliding[n];this.checkCollision(s.target)||(delete this.colliding[n],this.trigger("collideEnd",s.target,s))}},drawInspect(){let n=this.localArea();ee(),De(this.area.scale),V(this.area.offset);let s={outline:{width:4/wn(),color:E(0,0,255)},anchor:this.anchor,fill:!1,fixed:this.fixed};n instanceof G?K({...s,pos:n.pos,width:n.width,height:n.height}):n instanceof ae?ye({...s,pts:n.pts}):n instanceof me&&ve({...s,pos:n.center,radius:n.radius}),X()},destroy(){t.forEach(n=>n.cancel())},area:{shape:e.shape??null,scale:e.scale??f(1),offset:e.offset??f(0),cursor:e.cursor??null},isClicked(){return Be()&&this.isHovering()},isHovering(){let n=this.fixed?te():On(te());return this.hasPoint(n)},checkCollision(n){if(this===n||!n.area||!n.exists())return null;let s=this.worldArea(),h=n.worldArea();return ur(s,h)},isColliding(n){let s=this.checkCollision(n);return s&&!s.isZero()},isTouching(n){return Boolean(this.checkCollision(n))},onClick(n){return this.onUpdate(()=>{this.isClicked()&&n()})},onHover(n){let s=!1;return this.onUpdate(()=>{s?s=this.isHovering():this.isHovering()&&(s=!0,n())})},onHoverUpdate(n){return this.onUpdate(()=>{this.isHovering()&&n()})},onHoverEnd(n){let s=!1;return this.onUpdate(()=>{s?this.isHovering()||(s=!1,n()):s=this.isHovering()})},onCollide(n,s){if(typeof n=="function"&&s===void 0)return this.on("collide",n);if(typeof n=="string")return this.onCollide((h,o)=>{h.is(n)&&s(h,o)})},onCollideUpdate(n,s){if(typeof n=="function"&&s===void 0)return this.on("collideUpdate",n);if(typeof n=="string")return this.on("collideUpdate",(h,o)=>h.is(n)&&s(h,o))},onCollideEnd(n,s){if(typeof n=="function"&&s===void 0)return this.on("collideEnd",n);if(typeof n=="string")return this.on("collideEnd",h=>h.is(n)&&s(h))},hasPoint(n){return ar(this.worldArea(),n)},pushOut(n){let s=this.checkCollision(n);s&&(this.pos=this.pos.add(s))},pushOutAll(){g.root.getAll().forEach(this.pushOut)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let n=this.localArea();if(!(n instanceof ae||n instanceof G))throw new Error("Only support polygon and rect shapes for now");let s=this.transform.scale(f(this.area.scale??1)).translate(this.area.offset);if(n instanceof G){let h=n.bbox(),o=rt(this.anchor||vt).add(1,1).scale(-.5).scale(h.width,h.height);s=s.translate(o)}return n.transform(s)},screenArea(){let n=this.worldArea();return this.fixed?n:n.transform(g.cam.transform)}}}u(Di,"area");function Ze(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,fixed:e.fixed,shader:e.shader,uniform:e.uniform}}u(Ze,"getRenderProps");function Nt(e,t={}){let n=null,s=null;if(!e)throw new Error("Please pass the resource name or data to sprite()");let h=u((o,l,d,m)=>{let w=f(1,1);return d&&m?(w.x=d/(o.width*l.w),w.y=m/(o.height*l.h)):d?(w.x=d/(o.width*l.w),w.y=w.x):m&&(w.y=m/(o.height*l.h),w.x=w.y),w},"calcTexScale");return{id:"sprite",width:0,height:0,frame:t.frame||0,quad:t.quad||new j(0,0,1,1),animSpeed:t.animSpeed??1,draw(){!n||dn({...Ze(this),sprite:n,frame:this.frame,quad:this.quad,flipX:t.flipX,flipY:t.flipY,tiled:t.tiled,width:t.width,height:t.height})},update(){if(!n){let l=cn(e);if(!l||!l.data)return;let d=l.data.frames[0].clone();t.quad&&(d=d.scale(t.quad));let m=h(l.data.tex,d,t.width,t.height);this.width=l.data.tex.width*d.w*m.x,this.height=l.data.tex.height*d.h*m.y,t.anim&&this.play(t.anim),n=l.data,this.trigger("spriteLoaded",n)}if(!s)return;let o=n.anims[s.name];if(typeof o=="number"){this.frame=o;return}if(o.speed===0)throw new Error("Sprite anim speed cannot be 0");s.timer+=Q()*this.animSpeed,s.timer>=1/s.speed&&(s.timer=0,o.from>o.to?(this.frame--,this.frame<o.to&&(s.loop?this.frame=o.from:(this.frame++,s.onEnd(),this.stop()))):(this.frame++,this.frame>o.to&&(s.loop?this.frame=o.from:(this.frame--,s.onEnd(),this.stop()))))},play(o,l={}){if(!n){this.on("spriteLoaded",()=>{this.play(o,l)});return}let d=n.anims[o];if(!d)throw new Error(`Anim not found: ${o}`);s&&this.stop(),s=typeof d=="number"?{name:o,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:o,timer:0,loop:l.loop??d.loop??!1,pingpong:l.pingpong??d.pingpong??!1,speed:l.speed??d.speed??10,onEnd:l.onEnd??(()=>{})},this.frame=typeof d=="number"?d:d.from,this.trigger("animStart",o)},stop(){if(!s)return;let o=s.name;s=null,this.trigger("animEnd",o)},numFrames(){return n?n.frames.length:0},curAnim(){return s?.name},flipX(o){t.flipX=o},flipY(o){t.flipY=o},onAnimEnd(o,l){return this.on("animEnd",d=>{d===o&&l()})},onAnimStart(o,l){return this.on("animStart",d=>{d===o&&l()})},renderArea(){return new G(f(0),this.width,this.height)},inspect(){if(typeof e=="string")return`"${e}"`}}}u(Nt,"sprite");function Mi(e,t={}){function n(s){let h=Ue({...Ze(s),text:s.text+"",size:s.textSize,font:s.font,width:t.width&&s.width,align:s.align,letterSpacing:s.letterSpacing,lineSpacing:s.lineSpacing,transform:s.textTransform,styles:s.textStyles});return t.width||(s.width=h.width/(s.scale?.x||1)),s.height=h.height/(s.scale?.y||1),h}return u(n,"update"),{id:"text",text:e,textSize:t.size??qs,font:t.font,width:t.width,height:0,align:t.align,lineSpacing:t.lineSpacing,letterSpacing:t.letterSpacing,textTransform:t.transform,textStyles:t.styles,add(){jt(()=>n(this))},draw(){Ee(n(this))},renderArea(){return new G(f(0),this.width,this.height)}}}u(Mi,"text");function Fi(e,t,n={}){return{id:"rect",width:e,height:t,radius:n.radius||0,draw(){K({...Ze(this),width:this.width,height:this.height,radius:this.radius})},renderArea(){return new G(f(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}u(Fi,"rect");function Bi(e,t){return{id:"rect",width:e,height:t,draw(){Me({...Ze(this),width:this.width,height:this.height})},renderArea(){return new G(f(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}u(Bi,"uvquad");function Li(e){return{id:"circle",radius:e,draw(){ve({...Ze(this),radius:this.radius})},renderArea(){return new me(f(0),this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}u(Li,"circle");function Ii(e=1,t=E(0,0,0)){return{id:"outline",outline:{width:e,color:t}}}u(Ii,"outline");function In(e,t){let n=new Se;return e&&t&&n.pushd(new we(e,t)),{id:"timer",wait(s,h){let o=new we(s,h),l=n.pushd(o);return{get paused(){return o.paused},set paused(d){o.paused=d},cancel:l}},update(){n.forEach((s,h)=>{s.tick(Q())&&n.delete(h)})}}}u(In,"timer");let Vi=640,Gi=65536;function Ni(e={}){let t=0,n=null,s=null,h=!1,o=[];return{id:"body",require:["pos","area"],jumpForce:e.jumpForce??Vi,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??0,add(){o.push(this.onCollideUpdate((l,d)=>{if(!l.is("body")||d.resolved||this.isStatic&&l.isStatic)return;let m=!this.isStatic&&l.isStatic?d:d.reverse();m.source.trigger("beforePhysicsResolve",m),m.target.trigger("beforePhysicsResolve",m.reverse()),!d.resolved&&(m.source.pos=m.source.pos.add(m.displacement),m.source.transform=Pn(m.source),d.resolved=!0,m.source.trigger("physicsResolve",m),m.target.trigger("physicsResolve",m.reverse()))})),o.push(this.onPhysicsResolve(l=>{g.gravity&&(l.isBottom()&&this.isFalling()?(t=0,n=l.target,s=l.target.pos,h?h=!1:this.trigger("ground",n)):l.isTop()&&this.isJumping()&&(t=0,this.trigger("headbutt",l.target)))}))},update(){if(!g.gravity||this.isStatic)return;if(h&&(n=null,s=null,this.trigger("fallOff"),h=!1),n)if(!this.isTouching(n)||!n.exists()||!n.is("body"))h=!0;else{!n.pos.eq(s)&&e.stickToPlatform!==!1&&this.moveBy(n.pos.sub(s)),s=n.pos;return}let l=t;t+=g.gravity*this.gravityScale*Q(),t=Math.min(t,e.maxVelocity??Gi),l<0&&t>=0&&this.trigger("fall"),this.move(0,t)},destroy(){o.forEach(l=>l.cancel())},onPhysicsResolve(l){return this.on("physicsResolve",l)},onBeforePhysicsResolve(l){return this.on("beforePhysicsResolve",l)},curPlatform(){return n},isGrounded(){return n!==null},isFalling(){return t>0},isJumping(){return t<0},jump(l){n=null,s=null,t=-l||-this.jumpForce},onGround(l){return this.on("ground",l)},onFall(l){return this.on("fall",l)},onFallOff(l){return this.on("fallOff",l)},onHeadbutt(l){return this.on("headbutt",l)}}}u(Ni,"body");function ji(e=2){let t=e,n=[];return{id:"doubleJump",require:["body"],numJumps:e,add(){n.push(this.onGround(()=>{t=this.numJumps}))},destroy(){n.forEach(s=>s.cancel())},doubleJump(s){t<=0||(t<this.numJumps&&this.trigger("doubleJump"),t--,this.jump(s))},onDoubleJump(s){return this.on("doubleJump",s)},inspect(){return`${t}`}}}u(ji,"doubleJump");function _i(e,t={}){return{id:"shader",shader:e,uniform:t}}u(_i,"shader");function ki(){return{id:"fixed",fixed:!0}}u(ki,"fixed");function Vn(e){return{id:"stay",stay:!0,scenesToStay:e}}u(Vn,"stay");function qi(e){if(e==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(t=1){this.setHP(e-t),this.trigger("hurt")},heal(t=1){this.setHP(e+t),this.trigger("heal")},hp(){return e},setHP(t){e=t,e<=0&&this.trigger("death")},onHurt(t){return this.on("hurt",t)},onHeal(t){return this.on("heal",t)},onDeath(t){return this.on("death",t)},inspect(){return`${e}`}}}u(qi,"health");function zi(e,t={}){if(e==null)throw new Error("lifespan() requires time");let n=t.fade??0;return{id:"lifespan",async add(){await Lt(e),n>0&&this.opacity&&await kt(this.opacity,0,n,s=>this.opacity=s,pe.linear),this.destroy()}}}u(zi,"lifespan");function Hi(e,t,n){if(!e)throw new Error("state() requires an initial state");let s={};function h(m){s[m]||(s[m]={enter:new W,end:new W,update:new W,draw:new W})}u(h,"initStateEvents");function o(m,w,v){return h(w),s[w][m].add(v)}u(o,"on");function l(m,w,...v){h(w),s[w][m].trigger(...v)}u(l,"trigger");let d=!1;return{id:"state",state:e,enterState(m,...w){if(d=!0,t&&!t.includes(m))throw new Error(`State not found: ${m}`);let v=this.state;if(n){if(!n?.[v])return;let y=typeof n[v]=="string"?[n[v]]:n[v];if(!y.includes(m))throw new Error(`Cannot transition state from "${v}" to "${m}". Available transitions: ${y.map(L=>`"${L}"`).join(", ")}`)}l("end",v,...w),this.state=m,l("enter",m,...w),l("enter",`${v} -> ${m}`,...w)},onStateTransition(m,w,v){return o("enter",`${m} -> ${w}`,v)},onStateEnter(m,w){return o("enter",m,w)},onStateUpdate(m,w){return o("update",m,w)},onStateDraw(m,w){return o("draw",m,w)},onStateEnd(m,w){return o("end",m,w)},update(){d||(l("enter",e),d=!0),l("update",this.state)},draw(){l("draw",this.state)},inspect(){return this.state}}}u(Hi,"state");function $i(e=1){let t=0,n=!1;return{require:["opacity"],add(){this.opacity=0},update(){n||(t+=Q(),this.opacity=wt(t,0,e,0,1),t>=e&&(this.opacity=1,n=!0))}}}u($i,"fadeIn");function jt(e){U.loaded?e():g.ev.on("load",e)}u(jt,"onLoad");function Yi(e,t){g.scenes[e]=t}u(Yi,"scene");function Xi(e,...t){if(!g.scenes[e])throw new Error(`Scene not found: ${e}`);g.ev.onOnce("frameEnd",()=>{g.ev=new ue,g.objEvents=new ue,g.root.get().forEach(n=>{(!n.stay||n.scenesToStay&&!n.scenesToStay.includes(e))&&g.root.remove(n)}),g.root.clearEvents(),g.cam={pos:null,scale:f(1),angle:0,shake:0,transform:new A},g.gravity=0,g.scenes[e](...t),i.debug!==!1&&Bn(),i.burp&&Ln()})}u(Xi,"go");function Ki(e,t){try{return JSON.parse(window.localStorage[e])}catch{return t?(Gn(e,t),t):null}}u(Ki,"getData");function Gn(e,t){window.localStorage[e]=JSON.stringify(t)}u(Gn,"setData");function Nn(e){let t=e(Ve);for(let n in t)Ve[n]=t[n],i.global!==!1&&(window[n]=t[n]);return Ve}u(Nn,"plug");function ft(){return f(_()/2,B()/2)}u(ft,"center");function Qi(e,t){return{id:"grid",gridPos:t.clone(),setGridPos(...n){let s=f(...n);this.gridPos=s.clone(),this.pos=f(this.gridPos.x*e.gridWidth(),this.gridPos.y*e.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(f(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(f(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(f(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(f(0,1)))}}}u(Qi,"grid");function Ji(e,t){if(!t.width||!t.height)throw new Error("Must provide level grid width & height.");let n=We([ht(t.pos??f(0))]),s=0,h={id:"level",gridWidth(){return t.width},gridHeight(){return t.height},getPos(...o){let l=f(...o);return f(l.x*t.width,l.y*t.height)},spawn(o,...l){let d=f(...l),m=(()=>{if(t[o]){if(typeof t[o]!="function")throw new Error("Level symbol def must be a function returning a component list");return t[o](d)}else if(t.any)return t.any(o,d)})();if(!m)return;let w=f(d.x*t.width,d.y*t.height);for(let v of m)if(v.id==="pos"){w.x+=v.pos.x,w.y+=v.pos.y;break}return m.push(ht(w)),m.push(Qi(this,d)),n.add(m)},levelWidth(){return s*t.width},levelHeight(){return e.length*t.height}};return n.use(h),e.forEach((o,l)=>{let d=o.split("");s=Math.max(d.length,s),d.forEach((m,w)=>{n.spawn(m,f(w,l))})}),n}u(Ji,"addLevel");function Zi(e){let t=a.canvas.captureStream(e),n=C.ctx.createMediaStreamDestination();C.masterNode.connect(n);let s=new MediaRecorder(t),h=[];return s.ondataavailable=o=>{o.data.size>0&&h.push(o.data)},s.onerror=()=>{C.masterNode.disconnect(n),t.getTracks().forEach(o=>o.stop())},s.start(),{resume(){s.resume()},pause(){s.pause()},stop(){return s.stop(),C.masterNode.disconnect(n),t.getTracks().forEach(o=>o.stop()),new Promise(o=>{s.onstop=()=>{o(new Blob(h,{type:"video/mp4"}))}})},download(o="kaboom.mp4"){this.stop().then(l=>Qt(o,l))}}}u(Zi,"record");function Wi(){return document.activeElement===a.canvas}u(Wi,"isFocused");function es(e){e.destroy()}u(es,"destroy");let We=g.root.add.bind(g.root),ts=g.root.readd.bind(g.root),ns=g.root.removeAll.bind(g.root),jn=g.root.get.bind(g.root),_n=g.root.getAll.bind(g.root);function kn(e=2,t=1){let n=0;return{id:"boom",require:["scale"],update(){let s=Math.sin(n*e)*t;s<0&&this.destroy(),this.scale=f(s),n+=Q()}}}u(kn,"boom");let rs=Re(null,mr),is=Re(null,pr);function ss(e,t={}){let n=We([ht(e),Vn()]),s=(t.speed||1)*5,h=t.scale||1;n.add([Nt(is),dt(0),Gt("center"),kn(s,h),...t.comps??[]]);let o=n.add([Nt(rs),dt(0),Gt("center"),In(.4/s,()=>o.use(kn(s,h))),...t.comps??[]]);return o.onDestroy(()=>n.destroy()),n}u(ss,"addKaboom");function qn(){g.root.update()}u(qn,"updateFrame");let os=64;class mt{source;target;displacement;resolved=!1;constructor(t,n,s,h=!1){this.source=t,this.target=n,this.displacement=s,this.resolved=h}reverse(){return new mt(this.target,this.source,this.displacement.scale(-1),this.resolved)}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}preventResolve(){this.resolved=!0}}u(mt,"Collision");function as(){let e={},t=i.hashGridSize||os,n=new A,s=[];function h(o){if(s.push(n),o.pos&&(n=n.translate(o.pos)),o.scale&&(n=n.scale(o.scale)),o.angle&&(n=n.rotateZ(o.angle)),o.transform=n.clone(),o.c("area")&&!o.paused){let l=o,m=l.worldArea().bbox(),w=Math.floor(m.pos.x/t),v=Math.floor(m.pos.y/t),y=Math.ceil((m.pos.x+m.width)/t),L=Math.ceil((m.pos.y+m.height)/t),P=new Set;for(let q=w;q<=y;q++)for(let z=v;z<=L;z++)if(!e[q])e[q]={},e[q][z]=[l];else if(!e[q][z])e[q][z]=[l];else{let xe=e[q][z];for(let J of xe){if(!J.exists()||P.has(J.id))continue;for(let S of l.collisionIgnore)J.is(S);for(let S of J.collisionIgnore)l.is(S);let k=l.checkCollision(J);if(k&&!k.isZero()){let S=new mt(l,J,k);l.trigger("collideUpdate",J,S);let N=S.reverse();N.resolved=S.resolved,J.trigger("collideUpdate",l,N)}P.add(J.id)}xe.push(l)}}o.get().forEach(h),n=s.pop()}u(h,"checkObj"),h(g.root)}u(as,"checkFrame");function us(){let e=g.cam,t=D.fromAngle(nt(0,360)).scale(e.shake);e.shake=ze(e.shake,0,5*Q()),e.transform=new A().translate(ft()).scale(e.scale).rotateZ(e.angle).translate((e.pos??ft()).scale(-1).add(t)),g.root.draw(),he()}u(us,"drawFrame");function cs(){let e=I();ce(()=>{let t=_()/2,n=24,s=f(_()/2,B()/2).sub(f(t/2,n/2));K({pos:f(0),width:_(),height:B(),color:E(0,0,0)}),K({pos:s,width:t,height:n,fill:!1,outline:{width:4}}),K({pos:s,width:t*e,height:n})}),g.ev.trigger("loading",e)}u(cs,"drawLoadScreen");function zn(e,t){ce(()=>{let n=f(8);ee(),V(e);let s=Ue({text:t,font:yt,size:16,pos:n,color:E(255,255,255),fixed:!0}),h=s.width+n.x*2,o=s.height+n.x*2;e.x+h>=_()&&V(f(-h,0)),e.y+o>=B()&&V(f(0,-o)),K({width:h,height:o,color:E(0,0,0),radius:4,opacity:.8,fixed:!0}),Ee(s),X()})}u(zn,"drawInspectText");function ls(){if(F.inspect){let e=null;for(let t of _n())if(t.c("area")&&t.isHovering()){e=t;break}if(g.root.drawInspect(),e){let t=[],n=e.inspect();for(let s in n)n[s]?t.push(`${s}: ${n[s]}`):t.push(`${s}`);zn(Qr(te()),t.join(`
`))}zn(f(8),`FPS: ${F.fps()}`)}F.paused&&ce(()=>{ee(),V(_(),0),V(-8,8);let e=32;K({width:e,height:e,anchor:"topright",color:E(0,0,0),opacity:.8,radius:4,fixed:!0});for(let t=1;t<=2;t++)K({width:4,height:e*.6,anchor:"center",pos:f(-e/3*t,e*.5),color:E(255,255,255),radius:2,fixed:!0});X()}),F.timeScale!==1&&ce(()=>{ee(),V(_(),B()),V(-8,-8);let e=8,t=Ue({text:F.timeScale.toFixed(1),font:yt,size:16,color:E(255,255,255),pos:f(-e),anchor:"botright",fixed:!0});K({width:t.width+e*2+e*4,height:t.height+e*2,anchor:"botright",color:E(0,0,0),opacity:.8,radius:4,fixed:!0});for(let n=0;n<2;n++){let s=F.timeScale<1;mn({p1:f(-t.width-e*(s?2:3.5),-e),p2:f(-t.width-e*(s?2:3.5),-e-t.height),p3:f(-t.width-e*(s?3.5:2),-e-t.height/2),pos:f(-n*e*1+(s?-e*.5:0),0),color:E(255,255,255),fixed:!0})}Ee(t),X()}),F.curRecording&&ce(()=>{ee(),V(0,B()),V(24,-24),ve({radius:12,color:E(255,0,0),opacity:$t(0,1,Mt()*4),fixed:!0}),X()}),F.showLog&&g.logs.length>0&&ce(()=>{ee(),V(0,B()),V(8,-8);let e=8,t=Ue({text:g.logs.join(`
`),font:yt,pos:f(e,-e),anchor:"botleft",size:16,width:_()*.6,lineSpacing:e/2,fixed:!0,styles:{time:{color:E(127,127,127)},info:{color:E(255,255,255)},error:{color:E(255,0,127)}}});K({width:t.width+e*2,height:t.height+e*2,anchor:"botleft",color:E(0,0,0),radius:4,opacity:.8,fixed:!0}),Ee(t),X()})}u(ls,"drawDebug");function hs(){let e=te(),t=u((s,h,o)=>{ve({radius:80/2,pos:s,outline:{width:4,color:E(0,0,0)},opacity:.5}),o&&ot({text:o,pos:s,color:E(0,0,0),size:40,anchor:"center",opacity:.5}),Be("left")&&or(new me(s,80/2),e)&&g.ev.onOnce("frameEnd",()=>{a.virtualButtonStates[h]="pressed",a.keyStates[h]="pressed"}),Je("left")&&g.ev.onOnce("frameEnd",()=>{a.virtualButtonStates[h]="released",a.keyStates[h]="released"})},"drawCircleButton"),n=u((s,h,o)=>{K({width:64,height:64,pos:s,outline:{width:4,color:E(0,0,0)},radius:4,anchor:"center",opacity:.5}),o&&ot({text:o,pos:s,color:E(0,0,0),size:40,anchor:"center",opacity:.5}),Be("left")&&He(new G(s.add(-64/2,-64/2),64,64),e)&&g.ev.onOnce("frameEnd",()=>{a.virtualButtonStates[h]="pressed",a.keyStates[h]="pressed"}),Je("left")&&g.ev.onOnce("frameEnd",()=>{a.virtualButtonStates[h]="released",a.keyStates[h]="released"})},"drawSquareButton");ce(()=>{t(f(_()-80,B()-160),"a"),t(f(_()-160,B()-80),"b"),n(f(60,B()-124),"left"),n(f(188,B()-124),"right"),n(f(124,B()-188),"up"),n(f(124,B()-60),"down")})}u(hs,"drawVirtualControls"),i.debug!==!1&&Bn(),i.burp&&Ln();function ds(e){g.ev.on("loading",e)}u(ds,"onLoadUpdate");function fs(e){g.ev.on("resize",e)}u(fs,"onResize");function ms(e){g.ev.on("error",e)}u(ms,"onError");function _t(e){Hn(()=>{ce(()=>{let s=_(),h=B(),o={size:36,width:s-32*2,letterSpacing:4,lineSpacing:4,font:yt,fixed:!0};K({width:s,height:h,color:E(0,0,255),fixed:!0});let l=Ue({...o,text:e.name,pos:f(32),color:E(255,128,0),fixed:!0});Ee(l),ot({...o,text:e.message,pos:f(32,32+l.height+16),fixed:!0}),X(),g.ev.trigger("error",e)})})}u(_t,"handleErr");function ps(){for(let e in a.keyStates)a.keyStates[e]=tn(a.keyStates[e]);for(let e in a.mouseStates)a.mouseStates[e]=tn(a.mouseStates[e]);for(let e in a.virtualButtonStates)a.virtualButtonStates[e]=tn(a.virtualButtonStates[e]);a.charInputted=[],a.isMouseMoved=!1,a.isKeyPressed=!1,a.isKeyPressedRepeat=!1,a.isKeyReleased=!1}u(ps,"resetInputState");function Hn(e){a.loopID!==null&&cancelAnimationFrame(a.loopID);let t=u(n=>{if(a.stopped)return;if(document.visibilityState!=="visible"){a.loopID=requestAnimationFrame(t);return}let s=n/1e3,h=s-a.realTime;a.realTime=s,a.skipTime||(a.dt=h,a.time+=Q(),a.fpsCounter.tick(a.dt)),a.skipTime=!1,a.numFrames++,Gr(),e(),Nr(),ps(),g.ev.trigger("frameEnd"),a.loopID=requestAnimationFrame(t)},"frame");t(0)}u(Hn,"run");function gs(){g.ev.onOnce("frameEnd",()=>{a.stopped=!0,c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);let e=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);for(let t=0;t<e;t++)c.activeTexture(c.TEXTURE0+t),c.bindTexture(c.TEXTURE_2D,null),c.bindTexture(c.TEXTURE_CUBE_MAP,null);c.bindBuffer(c.ARRAY_BUFFER,null),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null),r.forEach(t=>t()),c.deleteBuffer(p.vbuf),c.deleteBuffer(p.ibuf);for(let t in $)a.canvas.removeEventListener(t,$[t]);for(let t in Qe)document.removeEventListener(t,Qe[t]);for(let t in Fe)window.removeEventListener(t,Fe[t])})}u(gs,"quit");function kt(e,t,n,s,h=pe.linear){let o=0,l=[],d=ut(()=>{o+=Q();let m=Math.min(o/n,1);s(ze(e,t,h(m))),m===1&&(d.cancel(),s(t),l.forEach(w=>w()))});return{get paused(){return d.paused},set paused(m){d.paused=m},onFinish(m){l.push(m)},then(m){return this.onFinish(m),this},cancel(){d.cancel()},finish(){d.cancel(),s(t),l.forEach(m=>m())}}}u(kt,"tween"),Oe("happy",dr,28,36),Hn(()=>{U.loaded||I()===1&&(U.loaded=!0,g.ev.trigger("load")),!U.loaded&&i.loadingScreen!==!1?cs():(g.ev.trigger("input"),F.paused||qn(),as(),us(),i.debug!==!1&&ls(),i.virtualControls&&An()&&hs())});let Ve={VERSION:Is,loadRoot:Y,loadProgress:I,loadSprite:Re,loadSpriteAtlas:rn,loadSound:Dr,loadBitmapFont:Oe,loadFont:xt,loadShader:Rr,loadAseprite:Pr,loadPedit:Or,loadBean:Mr,load:le,getSprite:sn,getSound:on,getFont:Fr,getBitmapFont:an,getShader:un,Asset:O,SpriteData:T,SoundData:R,width:_,height:B,center:ft,dt:Q,time:Mt,screenshot:Zr,record:Zi,isFocused:Wi,setCursor:Tn,setFullscreen:Wr,isFullscreen:Ft,isTouchScreen:An,onLoad:jt,onLoadUpdate:ds,onResize:fs,onError:ms,camPos:ei,camScale:ti,camRot:ni,shake:ri,toScreen:Bt,toWorld:On,gravity:Ei,add:We,destroy:es,destroyAll:ns,get:jn,getAll:_n,readd:ts,pos:ht,scale:dt,rotate:xi,color:Si,opacity:Ci,anchor:Gt,area:Di,sprite:Nt,text:Mi,rect:Fi,circle:Li,uvquad:Bi,outline:Ii,body:Ni,doubleJump:ji,shader:_i,timer:In,fixed:ki,stay:Vn,health:qi,lifespan:zi,z:Ti,move:Oi,offscreen:Ri,follow:Ai,state:Hi,fadeIn:$i,on:Le,onUpdate:ut,onDraw:Dn,onAdd:Mn,onDestroy:ii,onCollide:si,onClick:oi,onHover:ai,onHoverUpdate:ui,onHoverEnd:ci,onKeyDown:hi,onKeyPress:se,onKeyPressRepeat:It,onKeyRelease:Vt,onMouseDown:di,onMousePress:Fn,onMouseRelease:fi,onMouseMove:mi,onCharInput:pi,onTouchStart:gi,onTouchMove:wi,onTouchEnd:bi,onVirtualButtonPress:vi,onVirtualButtonDown:yi,onVirtualButtonRelease:Ui,mousePos:te,mouseDeltaPos:yn,isKeyDown:En,isKeyPressed:Pt,isKeyPressedRepeat:Rt,isKeyReleased:Dt,isMouseDown:Ot,isMousePressed:Be,isMouseReleased:Je,isMouseMoved:Un,isVirtualButtonPressed:xn,isVirtualButtonDown:Sn,isVirtualButtonReleased:Cn,loop:li,wait:Lt,play:Ye,volume:Ir,burp:hn,audioCtx:C.ctx,Timer:we,Line:ie,Rect:G,Circle:me,Polygon:ae,Vec2:D,Color:x,Mat4:A,Quad:j,RNG:ke,rand:nt,randi:Yt,randSeed:tr,vec2:f,rgb:E,hsl2rgb:Wn,quad:er,choose:rr,chance:nr,lerp:ze,tween:kt,easings:pe,map:wt,mapc:Zn,wave:$t,deg2rad:fe,rad2deg:Ht,testLineLine:je,testRectRect:ir,testRectLine:sr,testRectPoint:He,drawSprite:dn,drawText:ot,formatText:Ue,drawRect:K,drawLine:Ke,drawLines:fn,drawTriangle:mn,drawCircle:ve,drawEllipse:pn,drawUVQuad:Me,drawPolygon:ye,drawFormattedText:Ee,drawMasked:$r,drawSubtracted:Yr,pushTransform:ee,popTransform:X,pushTranslate:V,pushScale:De,pushRotate:zr,pushRotateX:kr,pushRotateY:qr,pushRotateZ:be,pushMatrix:_r,debug:F,scene:Yi,go:Xi,addLevel:Ji,getData:Ki,setData:Gn,download:bt,downloadJSON:lr,downloadText:Kt,downloadBlob:Qt,plug:Nn,ASCII_CHARS:br,canvas:a.canvas,addKaboom:ss,LEFT:D.LEFT,RIGHT:D.RIGHT,UP:D.UP,DOWN:D.DOWN,RED:x.RED,GREEN:x.GREEN,BLUE:x.BLUE,YELLOW:x.YELLOW,MAGENTA:x.MAGENTA,CYAN:x.CYAN,WHITE:x.WHITE,BLACK:x.BLACK,quit:gs,Event:W,EventHandler:ue};if(i.plugins&&i.plugins.forEach(Nn),i.global!==!1)for(let e in Ve)window[e]=Ve[e];return a.canvas.focus(),Ve},"default");return Ss(eo);})();
window.kaboom = kaboom.default
//# sourceMappingURL=kaboom.js.map
